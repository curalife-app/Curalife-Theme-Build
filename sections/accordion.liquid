{% comment %}
	SECTION: accordion-component.liquid
	Purpose: Displays a two-column layout with an image + text overlay on the left,
					 and an accordion on the right. Each accordion item is a block.
{% endcomment %}

<section id="accordion-component" class="accordion-component-section"
	style="display: flex; flex-wrap: wrap; max-width: 1200px; margin: 0 auto;">

	<!-- LEFT COLUMN (Background Image + Text Overlay) -->
	<div class="left-col"
			 style="
				 flex: 1 1 50%;
				 position: relative;
				 background-size: cover;
				 background-position: center;
				 display: flex;
				 align-items: center;
				 justify-content: center;
				 min-height: 400px;
				 {% if section.settings.background_image != blank %}
					 background-image: url('{{ section.settings.background_image | image_url: width:1200 }}');
				 {% endif %}
			 ">
		<div class="text-overlay"
				 style="
					 color: #fff;
					 text-align: center;
					 padding: 2rem;
					 max-width: 80%;
				 ">
			<h2 style="margin-bottom: 0.5rem;">
				{{ section.settings.heading }}
			</h2>
			{% if section.settings.subheading != blank %}
				<p style="margin-bottom: 0;">
					{{ section.settings.subheading }}
				</p>
			{% endif %}
		</div>
	</div>

	<!-- RIGHT COLUMN (Accordion) -->
	<div class="right-col"
			 style="
				 flex: 1 1 50%;
				 background: #fff;
				 padding: 2rem;
			 ">

		{% for block in section.blocks %}
			{% if block.type == 'accordion_item' %}
				<div class="accordion-item"
						 style="
							 border-bottom: 1px solid #ccc;
							 padding: 1rem 0;
						 ">
					<div class="accordion-header"
							 style="
								 cursor: pointer;
								 display: flex;
								 justify-content: space-between;
								 align-items: center;
							 ">
						<span style="font-weight: bold;">
							{{ block.settings.month_title }}
						</span>
						<span class="accordion-icon" style="margin-left: 1rem;">+</span>
					</div>
					<div class="accordion-content"
							 style="
								 overflow: hidden;
								 max-height: 0;
								 transition: max-height 0.3s ease;
								 margin-top: 0.5rem;
							 ">
						<h4 style="margin: 0 0 0.25rem;">
							{{ block.settings.subtitle }}
						</h4>
						<p style="margin: 0;">
							{{ block.settings.description }}
						</p>
					</div>
				</div>
			{% endif %}
		{% endfor %}

	</div>
</section>

<!-- JavaScript to handle accordion toggle -->
<script>
document.addEventListener('DOMContentLoaded', function() {
	var accordionHeaders = document.querySelectorAll('#accordion-component .accordion-header');

	accordionHeaders.forEach(function(header) {
		header.addEventListener('click', function() {
			var parentItem = header.parentElement;
			var content = parentItem.querySelector('.accordion-content');
			var icon = header.querySelector('.accordion-icon');


			document.querySelectorAll('#accordion-component .accordion-content').forEach(function(otherContent) {
			  if (otherContent !== content) {
			    otherContent.style.maxHeight = null;
			    otherContent.parentElement.querySelector('.accordion-icon').textContent = '+';
			  }
			});

			// Toggle current accordion
			if (content.style.maxHeight) {
				// Currently open; close it
				content.style.maxHeight = null;
				icon.textContent = '+';
			} else {
				// Open it
				content.style.maxHeight = content.scrollHeight + 'px';
				icon.textContent = '-';
			}
		});
	});
});
</script>

{% schema %}
{
	"name": "Accordion",
	"settings": [
		{
			"type": "text",
			"id": "heading",
			"label": "Main Heading",
			"default": "Your Journey: Shed Pounds & Feel Great"
		},
		{
			"type": "textarea",
			"id": "subheading",
			"label": "Subheading",
			"default": "Add any supporting text or tagline here."
		},
		{
			"type": "image_picker",
			"id": "background_image",
			"label": "Background Image",
			"default": ""
		}
	],
	"blocks": [
		{
			"type": "accordion_item",
			"name": "Accordion Item",
			"settings": [
				{
					"type": "text",
					"id": "month_title",
					"label": "Month Title",
					"default": "Month 3"
				},
				{
					"type": "text",
					"id": "subtitle",
					"label": "Subtitle",
					"default": "Getting Started"
				},
				{
					"type": "textarea",
					"id": "description",
					"label": "Description",
					"default": "Take the product twice a day to establish a routine. Consistent use will help reduce cravings and build healthy habits."
				}
			]
		}
	],
	"max_blocks": 12,
	"presets": [
		{
			"name": "Accordion",
			"category": "Custom"
		}
	]
}
{% endschema %}
