!function(){function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function t(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?e(Object(i),!0).forEach((function(e){d(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,a,o,s=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(s.push(i.value),s.length!==t);l=!0);}catch(e){u=!0,r=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw r}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function a(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function s(n,i,r,a){var s=i&&i.prototype instanceof u?i:u,c=Object.create(s.prototype);return o(c,"_invoke",function(n,i,r){var a,o,s,u=0,c=r||[],d=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return a=t,o=0,s=e,p.n=n,l}};function h(n,i){for(o=n,s=i,t=0;!d&&u&&!r&&t<c.length;t++){var r,a=c[t],h=p.p,f=a[2];n>3?(r=f===i)&&(s=a[(o=a[4])?5:(o=3,3)],a[4]=a[5]=e):a[0]<=h&&((r=n<2&&h<a[1])?(o=0,p.v=i,p.n=a[1]):h<f&&(r=n<3||a[0]>i||i>f)&&(a[4]=n,a[5]=i,p.n=f,o=0))}if(r||n>1)return l;throw d=!0,i}return function(r,c,f){if(u>1)throw TypeError("Generator is already running");for(d&&1===c&&h(c,f),o=c,s=f;(t=o<2?e:s)||!d;){a||(o?o<3?(o>1&&(p.n=-1),h(o,s)):p.n=s:p.v=s);try{if(u=2,a){if(o||(r="next"),t=a[r]){if(!(t=t.call(a,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,o<2&&(o=0)}else 1===o&&(t=a.return)&&t.call(a),o<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),o=1);a=e}else if((t=(d=p.n<0)?s:n.call(i,p))!==l)break}catch(t){a=e,o=1,s=t}finally{u=1}}return{value:t,done:d}}}(n,r,a),!0),c}var l={};function u(){}function c(){}function d(){}t=Object.getPrototypeOf;var p=[][i]?t(t([][i]())):(o(t={},i,(function(){return this})),t),h=d.prototype=u.prototype=Object.create(p);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,r,"GeneratorFunction")),e.prototype=Object.create(h),e}return c.prototype=d,o(h,"constructor",d),o(d,"constructor",c),c.displayName="GeneratorFunction",o(d,r,"GeneratorFunction"),o(h),o(h,r,"Generator"),o(h,i,(function(){return this})),o(h,"toString",(function(){return"[object Generator]"})),(a=function(){return{w:s,m:f}})()}function o(e,t,n,i){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}o=function(e,t,n,i){if(t)r?r(e,t,{value:n,enumerable:!i,configurable:!i,writable:!i}):e[t]=n;else{var a=function(t,n){o(e,t,(function(e){return this._invoke(t,n,e)}))};a("next",0),a("throw",1),a("return",2)}},o(e,t,n,i)}function s(e,t,n,i,r,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,r)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var a=e.apply(t,n);function o(e){s(a,i,r,o,l,"next",e)}function l(e){s(a,i,r,o,l,"throw",e)}o(void 0)}))}}function u(e,t,n,i){var r=c(q(1&i?e.prototype:e),t,n);return 2&i&&"function"==typeof r?function(e){return r.apply(n,e)}:r}function c(){return c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=q(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},c.apply(null,arguments)}function d(e,t,n){return(t=m(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,m(i.key),i)}}function f(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function m(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}function y(e,t,n){return t=q(t),v(e,S()?Reflect.construct(t,n||[],q(e).constructor):t.apply(e,n))}function v(e,t){if(t&&("object"==n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}function g(e){var t="function"==typeof Map?new Map:void 0;return g=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return function(e,t,n){if(S())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,t);var r=new(e.bind.apply(e,i));return n&&w(r,n.prototype),r}(e,arguments,q(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),w(n,e)},g(e)}function S(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(S=function(){return!!e})()}function w(e,t){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},w(e,t)}function q(e){return q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},q(e)}System.register(["./pubsub-legacy-chunk.js"],(function(e,r){"use strict";return{setters:[null],execute:function(){customElements.get("product-form")||customElements.define("product-form",function(e){function t(){var e;return p(this,t),(e=y(this,t)).form=e.querySelector("form"),e.form.querySelector("[name=id]").disabled=!1,e.form.addEventListener("submit",e.onSubmitHandler.bind(e)),e.cart=document.querySelector("cart-notification")||document.querySelector("cart-drawer"),e.submitButton=e.querySelector('[type="submit"]'),document.querySelector("cart-drawer")&&e.submitButton.setAttribute("aria-haspopup","dialog"),e.hideErrors="true"===e.dataset.hideErrors,e}return b(t,e),f(t,[{key:"onSubmitHandler",value:function(e){var t=this;if(e.preventDefault(),"true"!==this.submitButton.getAttribute("aria-disabled")){this.handleErrorMessage(),this.submitButton.setAttribute("aria-disabled",!0),this.submitButton.classList.add("loading"),this.querySelector(".submit-title").classList.add("hidden"),this.querySelector(".loading-overlay__spinner").classList.remove("hidden");var n=fetchConfig("javascript");n.headers["X-Requested-With"]="XMLHttpRequest",delete n.headers["Content-Type"];var i=new FormData(this.form);this.cart&&("function"==typeof this.cart.getSectionsToRender?i.append("sections",this.cart.getSectionsToRender().map((function(e){return e.id}))):i.append("sections",""),i.append("sections_url",window.location.pathname),"function"==typeof this.cart.setActiveElement&&this.cart.setActiveElement(document.activeElement)),n.body=i,fetch("".concat(routes.cart_add_url),n).then((function(e){return e.json()})).then((function(e){if(e.status){"function"==typeof publish&&publish(PUB_SUB_EVENTS.cartError,{source:"product-form",productVariantId:i.get("id"),errors:e.errors||e.description,message:e.message}),t.handleErrorMessage(e.description);var n=t.submitButton.querySelector(".sold-out-message");if(!n)return;return t.submitButton.setAttribute("aria-disabled",!0),t.submitButton.querySelector("span").classList.add("hidden"),n.classList.remove("hidden"),void(t.error=!0)}if(t.cart){t.error||"function"!=typeof publish||publish(PUB_SUB_EVENTS.cartUpdate,{source:"product-form",productVariantId:i.get("id"),cartData:e}),t.error=!1;var r=t.closest("quick-add-modal");r?(document.body.addEventListener("modalClosed",(function(){setTimeout((function(){"function"==typeof t.cart.renderContents&&t.cart.renderContents(e)}))}),{once:!0}),r.hide(!0)):"function"==typeof t.cart.renderContents&&t.cart.renderContents(e)}else window.location=window.routes.cart_url})).catch((function(e){console.error(e)})).finally((function(){t.submitButton.classList.remove("loading"),t.cart&&t.cart.classList.contains("is-empty")&&t.cart.classList.remove("is-empty"),t.error||t.submitButton.removeAttribute("aria-disabled"),t.querySelector(".submit-title").classList.remove("hidden"),t.querySelector(".loading-overlay__spinner").classList.add("hidden");var e=t.form.querySelector("[name=quantity]");e&&(e.value=1)}))}}},{key:"handleErrorMessage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.hideErrors||(this.errorMessageWrapper=this.errorMessageWrapper||this.querySelector(".product-form__error-message-wrapper"),this.errorMessageWrapper&&(this.errorMessage=this.errorMessage||this.errorMessageWrapper.querySelector(".product-form__error-message"),this.errorMessageWrapper.toggleAttribute("hidden",!e),e&&(this.errorMessage.textContent=e)))}}])}(g(HTMLElement)));var e=function(e){function t(){var e;return p(this,t),d(e=y(this,t),"quantityUpdateUnsubscriber",void 0),e.input=e.querySelector("input"),e.changeEvent=new Event("change",{bubbles:!0}),e.input.addEventListener("change",e.onInputChange.bind(e)),e.querySelectorAll("button").forEach((function(t){return t.addEventListener("click",e.onButtonClick.bind(e))})),e}return b(t,e),f(t,[{key:"connectedCallback",value:function(){this.validateQtyRules(),this.quantityUpdateUnsubscriber=subscribe(PUB_SUB_EVENTS.quantityUpdate,this.validateQtyRules.bind(this))}},{key:"disconnectedCallback",value:function(){this.quantityUpdateUnsubscriber&&this.quantityUpdateUnsubscriber()}},{key:"onInputChange",value:function(e){this.validateQtyRules()}},{key:"onButtonClick",value:function(e){e.preventDefault();var t=this.input.value;"plus"===e.target.name?this.input.stepUp():this.input.stepDown(),t!==this.input.value&&this.input.dispatchEvent(this.changeEvent)}},{key:"validateQtyRules",value:function(){var e=parseInt(this.input.value);if(this.input.min){var t=parseInt(this.input.min);this.querySelector(".quantity__button[name='minus']").classList.toggle("disabled",e<=t)}if(this.input.max){var n=parseInt(this.input.max);this.querySelector(".quantity__button[name='plus']").classList.toggle("disabled",e>=n)}}}])}(g(HTMLElement));customElements.define("quantity-input",e),customElements.get("product-info")||customElements.define("product-info",function(e){function t(){var e;return p(this,t),d(e=y(this,t),"cartUpdateUnsubscriber",void 0),d(e,"variantChangeUnsubscriber",void 0),e.input=e.querySelector(".quantity__input"),e.currentVariant=e.querySelector(".product-variant-id"),e.variantSelects=e.querySelector("variant-radios"),e.submitButton=e.querySelector('[type="submit"]'),e}return b(t,e),f(t,[{key:"connectedCallback",value:function(){var e=this;this.input&&(this.quantityForm=this.querySelector(".product-form__quantity"),this.quantityForm&&(this.setQuantityBoundries(),this.dataset.originalSection||(this.cartUpdateUnsubscriber=subscribe(PUB_SUB_EVENTS.cartUpdate,this.fetchQuantityRules.bind(this))),this.variantChangeUnsubscriber=subscribe(PUB_SUB_EVENTS.variantChange,(function(t){var n=e.dataset.originalSection?e.dataset.originalSection:e.dataset.section;t.data.sectionId===n&&(e.updateQuantityRules(t.data.sectionId,t.data.html),e.setQuantityBoundries())}))))}},{key:"disconnectedCallback",value:function(){this.cartUpdateUnsubscriber&&this.cartUpdateUnsubscriber(),this.variantChangeUnsubscriber&&this.variantChangeUnsubscriber()}},{key:"setQuantityBoundries",value:function(){var e={cartQuantity:this.input.dataset.cartQuantity?parseInt(this.input.dataset.cartQuantity):0,min:this.input.dataset.min?parseInt(this.input.dataset.min):1,max:this.input.dataset.max?parseInt(this.input.dataset.max):null,step:this.input.step?parseInt(this.input.step):1},t=e.min,n=null===e.max?e.max:e.max-e.cartQuantity;null!==n&&(t=Math.min(t,n)),e.cartQuantity>=e.min&&(t=Math.min(t,e.step)),this.input.min=t,this.input.max=n,this.input.value=t,publish(PUB_SUB_EVENTS.quantityUpdate,void 0)}},{key:"fetchQuantityRules",value:function(){var e=this;this.currentVariant&&this.currentVariant.value&&(this.querySelector(".quantity__rules-cart .loading-overlay").classList.remove("hidden"),fetch("".concat(this.dataset.url,"?variant=").concat(this.currentVariant.value,"&section_id=").concat(this.dataset.section)).then((function(e){return e.text()})).then((function(t){var n=(new DOMParser).parseFromString(t,"text/html");e.updateQuantityRules(e.dataset.section,n),e.setQuantityBoundries()})).catch((function(e){console.error(e)})).finally((function(){e.querySelector(".quantity__rules-cart .loading-overlay").classList.add("hidden")})))}},{key:"updateQuantityRules",value:function(e,t){for(var n=t.getElementById("Quantity-Form-".concat(e)),i=0,r=[".quantity__input",".quantity__rules",".quantity__label"];i<r.length;i++){var a=r[i],o=this.quantityForm.querySelector(a),s=n.querySelector(a);if(o&&s)if(".quantity__input"===a)for(var l=0,u=["data-cart-quantity","data-min","data-max","step"];l<u.length;l++){var c=u[l],d=s.getAttribute(c);null!==d&&o.setAttribute(c,d)}else o.innerHTML=s.innerHTML}}}])}(g(HTMLElement))),customElements.get("product-modal")||customElements.define("product-modal",function(){function e(){return p(this,e),y(this,e)}return b(e,ModalDialog),f(e,[{key:"hide",value:function(){u(e,"hide",this,3)([])}},{key:"show",value:function(t){u(e,"show",this,3)([t]),this.showActiveMedia()}},{key:"showActiveMedia",value:function(){this.querySelectorAll('[data-media-id]:not([data-media-id="'.concat(this.openedBy.getAttribute("data-media-id"),'"])')).forEach((function(e){e.classList.remove("active")}));var e=this.querySelector('[data-media-id="'.concat(this.openedBy.getAttribute("data-media-id"),'"]')),t=e.querySelector("template"),n=t?t.content:null;e.classList.add("active"),e.scrollIntoView();var i=this.querySelector('[role="document"]');i.scrollLeft=(e.width-i.clientWidth)/2,"DEFERRED-MEDIA"==e.nodeName&&n&&n.querySelector(".js-youtube")&&e.loadContent()}}])}()),customElements.get("product-model")||customElements.define("product-model",function(){function e(){return p(this,e),y(this,e)}return b(e,DeferredMedia),f(e,[{key:"loadContent",value:function(){u(e,"loadContent",this,3)([]),Shopify.loadFeatures([{name:"model-viewer-ui",version:"1.0",onLoad:this.setupModelViewerUI.bind(this)}])}},{key:"setupModelViewerUI",value:function(e){e||(this.modelViewerUI=new Shopify.ModelViewerUI(this.querySelector("model-viewer")))}}])}()),window.ProductModel={loadShopifyXR:function(){Shopify.loadFeatures([{name:"shopify-xr",version:"1.0",onLoad:this.setupShopifyXR.bind(this)}])},setupShopifyXR:function(e){var t=this;e||(window.ShopifyXR?(document.querySelectorAll('[id^="ProductJSON-"]').forEach((function(e){window.ShopifyXR.addModels(JSON.parse(e.textContent)),e.remove()})),window.ShopifyXR.setupXRElements()):document.addEventListener("shopify_xr_initialized",(function(){return t.setupShopifyXR()})))}},window.addEventListener("DOMContentLoaded",(function(){window.ProductModel&&window.ProductModel.loadShopifyXR()})),customElements.get("quick-add-modal")||customElements.define("quick-add-modal",function(){function e(){var t;return p(this,e),(t=y(this,e)).modalContent=t.querySelector('[id^="QuickAddInfo-"]'),t}return b(e,ModalDialog),f(e,[{key:"hide",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=document.querySelector("cart-notification")||document.querySelector("cart-drawer");n&&n.setActiveElement(this.openedBy),this.modalContent.innerHTML="",t&&(this.openedBy=null),u(e,"hide",this,3)([])}},{key:"show",value:function(t){var n=this;t.setAttribute("aria-disabled",!0),t.classList.add("loading"),t.querySelector(".loading-overlay__spinner").classList.remove("hidden"),fetch(t.getAttribute("data-product-url")).then((function(e){return e.text()})).then((function(i){var r=(new DOMParser).parseFromString(i,"text/html");n.productElement=r.querySelector('section[id^="MainProduct-"]'),n.preventDuplicatedIDs(),n.removeDOMElements(),n.setInnerHTML(n.modalContent,n.productElement.innerHTML),window.Shopify&&Shopify.PaymentButton&&Shopify.PaymentButton.init(),window.ProductModel&&window.ProductModel.loadShopifyXR(),n.removeGalleryListSemantic(),n.updateImageSizes(),n.preventVariantURLSwitching(),u(e,"show",n,3)([t])})).finally((function(){t.removeAttribute("aria-disabled"),t.classList.remove("loading"),t.querySelector(".loading-overlay__spinner").classList.add("hidden")}))}},{key:"setInnerHTML",value:function(e,t){e.innerHTML=t,e.querySelectorAll("script").forEach((function(e){var t=document.createElement("script");Array.from(e.attributes).forEach((function(e){t.setAttribute(e.name,e.value)})),t.appendChild(document.createTextNode(e.innerHTML)),e.parentNode.replaceChild(t,e)}))}},{key:"preventVariantURLSwitching",value:function(){var e=this.modalContent.querySelector("variant-radios,variant-selects");e&&e.setAttribute("data-update-url","false")}},{key:"removeDOMElements",value:function(){var e=this.productElement.querySelector("pickup-availability");e&&e.remove();var t=this.productElement.querySelector("product-modal");t&&t.remove();var n=this.productElement.querySelectorAll("modal-dialog");n&&n.forEach((function(e){return e.remove()}))}},{key:"preventDuplicatedIDs",value:function(){var e=this.productElement.dataset.section;this.productElement.innerHTML=this.productElement.innerHTML.replaceAll(e,"quickadd-".concat(e)),this.productElement.querySelectorAll("variant-selects, variant-radios, product-info").forEach((function(t){t.dataset.originalSection=e}))}},{key:"removeGalleryListSemantic",value:function(){var e=this.modalContent.querySelector('[id^="Slider-Gallery"]');e&&(e.setAttribute("role","presentation"),e.querySelectorAll('[id^="Slide-"]').forEach((function(e){return e.setAttribute("role","presentation")})))}},{key:"updateImageSizes",value:function(){var e=this.modalContent.querySelector(".product");if(e.classList.contains("product--columns")){var t=e.querySelectorAll(".product__media img");if(t.length){var n="(min-width: 1000px) 715px, (min-width: 750px) calc((100vw - 11.5rem) / 2), calc(100vw - 4rem)";e.classList.contains("product--medium")?n=n.replace("715px","605px"):e.classList.contains("product--small")&&(n=n.replace("715px","495px")),t.forEach((function(e){return e.setAttribute("sizes",n)}))}}}}])}()),customElements.get("pickup-availability")||customElements.define("pickup-availability",function(e){function t(){var e;return p(this,t),(e=y(this,t)).hasAttribute("available")?(e.errorHtml=e.querySelector("template").content.firstElementChild.cloneNode(!0),e.onClickRefreshList=e.onClickRefreshList.bind(e),e.fetchAvailability(e.dataset.variantId),e):v(e)}return b(t,e),f(t,[{key:"fetchAvailability",value:function(e){var t=this,n=this.dataset.rootUrl;n.endsWith("/")||(n+="/");var i="".concat(n,"variants/").concat(e,"/?section_id=pickup-availability");fetch(i).then((function(e){return e.text()})).then((function(e){var n=(new DOMParser).parseFromString(e,"text/html").querySelector(".shopify-section");t.renderPreview(n)})).catch((function(e){var n=t.querySelector("button");n&&n.removeEventListener("click",t.onClickRefreshList),t.renderError()}))}},{key:"onClickRefreshList",value:function(e){this.fetchAvailability(this.dataset.variantId)}},{key:"renderError",value:function(){this.innerHTML="",this.appendChild(this.errorHtml),this.querySelector("button").addEventListener("click",this.onClickRefreshList)}},{key:"renderPreview",value:function(e){var t=document.querySelector("pickup-availability-drawer");if(t&&t.remove(),!e.querySelector("pickup-availability-preview"))return this.innerHTML="",void this.removeAttribute("available");this.innerHTML=e.querySelector("pickup-availability-preview").outerHTML,this.setAttribute("available",""),document.body.appendChild(e.querySelector("pickup-availability-drawer"));var n=this.querySelector("button");n&&n.addEventListener("click",(function(e){document.querySelector("pickup-availability-drawer").show(e.target)}))}}])}(g(HTMLElement))),customElements.get("pickup-availability-drawer")||customElements.define("pickup-availability-drawer",function(e){function t(){var e;return p(this,t),(e=y(this,t)).onBodyClick=e.handleBodyClick.bind(e),e.querySelector("button").addEventListener("click",(function(){e.hide()})),e.addEventListener("keyup",(function(t){"ESCAPE"===t.code.toUpperCase()&&e.hide()})),e}return b(t,e),f(t,[{key:"handleBodyClick",value:function(e){var t=e.target;t==this||t.closest("pickup-availability-drawer")||"ShowPickupAvailabilityDrawer"==t.id||this.hide()}},{key:"hide",value:function(){this.removeAttribute("open"),document.body.removeEventListener("click",this.onBodyClick),document.body.classList.remove("overflow-hidden"),removeTrapFocus(this.focusElement)}},{key:"show",value:function(e){this.focusElement=e,this.setAttribute("open",""),document.body.addEventListener("click",this.onBodyClick),document.body.classList.add("overflow-hidden"),trapFocus(this)}}])}(g(HTMLElement)));var r={data:null,lastFetched:0,maxAge:2e3,getCart:function(){var e=arguments,t=this;return l(a().m((function n(){var i,r,o,s;return a().w((function(n){for(;;)switch(n.n){case 0:if(i=e.length>0&&void 0!==e[0]&&e[0],r=Date.now(),!(!i&&t.data&&r-t.lastFetched<t.maxAge)){n.n=1;break}return n.a(2,t.data);case 1:return n.p=1,n.n=2,fetch("/cart.js?t="+r,{cache:"no-store",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});case 2:if((o=n.v).ok){n.n=3;break}throw new Error("Failed to fetch cart");case 3:return n.n=4,o.json();case 4:return t.data=n.v,t.lastFetched=r,n.a(2,t.data);case 5:throw n.p=5,s=n.v,console.error("Error fetching cart:",s),s;case 6:return n.a(2)}}),n,null,[[1,5]])})))()},invalidate:function(){this.data=null,this.lastFetched=0}},o=function(e,t,n){return!!e&&(e[t]!==n&&(e[t]=n,!0))},s=function(e,t,n){return!!e&&(e.getAttribute(t)!==n&&(e.setAttribute(t,n),!0))},c=function(e,t,n){if(!e)return!1;var i=e.classList.contains(t);return n&&!i?(e.classList.add(t),!0):!(n||!i)&&(e.classList.remove(t),!0)},h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=document.createElement(e);return Object.entries(t).forEach((function(e){var t=i(e,2),r=t[0],o=t[1];if("className"===r)a.className=o;else if("innerHTML"===r)a.innerHTML=o;else if("textContent"===r)a.textContent=o;else if("style"===r&&"object"===n(o))Object.entries(o).forEach((function(e){var t=i(e,2),n=t[0],r=t[1];a.style[n]=r}));else if(r.startsWith("data-"))a.setAttribute(r,o);else if(r.startsWith("on")&&"function"==typeof o){var s=r.substring(2).toLowerCase();a.addEventListener(s,o)}else a[r]=o})),r&&r.appendChild(a),a};function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error",n=document.createElement("div");n.className="\n\t\tcart-notification ".concat(t,"\n\t\tfixed bottom-4 left-1/2 transform -translate-x-1/2\n\t\tp-4 rounded-lg shadow-lg z-[2147483640]\n\t\ttransition-opacity duration-300\n\t").replace(/\s+/g," "),"error"===t?n.classList.add("bg-red-100","border","border-red-400","text-red-700"):n.classList.add("bg-green-100","border","border-green-400","text-green-700"),n.innerHTML='\n\t\t<div class="flex items-center">\n\t\t\t<div class="mr-3">'.concat("error"===t?"⚠️":"✅",'</div>\n\t\t\t<div class="text-sm font-medium">').concat(e,'</div>\n\t\t\t<button\n\t\t\t\tclass="hover:text-gray-500 ml-auto text-gray-400"\n\t\t\t\tonclick="this.parentElement.parentElement.remove()"\n\t\t\t>\n\t\t\t\t✕\n\t\t\t</button>\n\t\t</div>\n\t'),document.body.appendChild(n),setTimeout((function(){n.classList.add("opacity-0"),setTimeout((function(){return n.remove()}),300)}),5e3)}function S(e){var t,i,r,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(console.error("Error in ".concat(o,":"),{message:e.message,response:e.response,stack:e.stack,originalError:e}),e.response&&"object"===n(e.response)){if(e.response.description)return e.response.description;if(e.response.message)return e.response.message}if(null!==(t=e.message)&&void 0!==t&&t.includes("network"))return"Network connection issue. Please check your internet connection and try again.";if(null!==(i=e.message)&&void 0!==i&&i.includes("timeout"))return"Request timed out. Please try again.";if(null!==(r=e.message)&&void 0!==r&&r.includes("sold out"))return"This product is currently sold out. Please try again later.";if(null!==(a=e.message)&&void 0!==a&&a.includes("variant"))return"There was an issue with the selected option. Please try selecting a different option.";switch(o){case"cart-add":return"Unable to add items to your cart. Please try again.";case"checkout":return"Unable to proceed to checkout. Please try again.";case"frequency-selection":return"Unable to update subscription frequency. Please try again.";default:return"Something went wrong. Please try again or contact customer support."}}function w(){return q.apply(this,arguments)}function q(){return q=l(a().m((function e(){var t,n,i=arguments;return a().w((function(e){for(;;)switch(e.n){case 0:return t=i.length>0&&void 0!==i[0]&&i[0],e.p=1,e.n=2,r.getCart(t);case 2:return e.a(2,e.v);case 3:throw e.p=3,n=e.v,console.error("Error in getCart:",n),new Error("Unable to access your cart");case 4:return e.a(2)}}),e,null,[[1,3]])}))),q.apply(this,arguments)}function k(){return I.apply(this,arguments)}function I(){return(I=l(a().m((function e(){var t,n,i;return a().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,fetch("/cart/clear.js",{method:"POST",cache:"no-store",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});case 1:if((t=e.v).ok){e.n=3;break}return e.n=2,t.json();case 2:throw n=e.v,Object.assign(new Error("Failed to clear cart"),{response:n});case 3:return r.invalidate(),e.a(2,t.json());case 4:throw e.p=4,i=e.v,console.error("Error clearing cart:",i),i;case 5:return e.a(2)}}),e,null,[[0,4]])})))).apply(this,arguments)}function E(e){if(!e)return{value:1,unit:"month"};var t=e.match(/(\d+)\s*Day/i);if(t)return{value:parseInt(t[1],10),unit:"day"};var n=e.match(/(\d+)\s*Week/i);if(n)return{value:parseInt(n[1],10),unit:"week"};var i=e.match(/(\d+)\s*Month/i);return i?{value:parseInt(i[1],10),unit:"month"}:{value:1,unit:"month"}}var T=new Map,x=function(){return f((function e(t,n){if(p(this,e),T.has(n.SID))return T.get(n.SID);this.container=t,this.config=n,this.elements={},this.state={selectedBox:null,selectedFrequency:null,isInitialLoad:!0,isLoading:!1,isRedirectingToCheckout:!1,productId:null,variantId:null,sellingPlanId:null,purchaseType:null,currencySymbol:this.config.currencySymbol||"$",loadingButton:null},this.container&&(T.set(n.SID,this),this.bindElements(),this.storeInitialProductData(),this.initState(),this.attachEventListeners(),this.moveCtaTextIfNeeded())}),[{key:"bindElements",value:function(){this.elements.productActions=this.container,this.elements.productActions&&this.elements.productActions.classList.contains("product-actions")&&(this.elements.purchaseOptionBoxes=this.elements.productActions.querySelectorAll(".variant-box"),this.elements.submitButton=this.elements.productActions.querySelector(".checkout-button button"),this.elements.submitSellingPlanId=this.elements.productActions.querySelector(".submit-selling-plan-id"),this.elements.submitVariantId=this.elements.productActions.querySelector(".submit-variant-id"),this.elements.sellingPlanInput=this.elements.productActions.querySelector('input[name="selling_plan"]'),this.elements.oneTimeButton=this.elements.productActions.querySelector(".one-time-add-to-cart"),this.elements.frequencyContainer=this.elements.productActions.querySelector("[data-frequency-container]"),this.elements.frequencyOptions=this.elements.productActions.querySelector("#frequency-options-".concat(this.config.SID)),this.elements.frequencyDropdown=this.elements.productActions.querySelector("#frequency-dropdown-".concat(this.config.SID)),this.elements.frequencyDescription=this.elements.productActions.querySelector(".frequency-description"),this.elements.priceDisplays=this.elements.productActions.querySelectorAll(".price-display"),this.elements.ctaText=this.container.querySelector(".cta-text"),this.elements.giftContainer=this.elements.productActions.querySelector(".gift-container"))}},{key:"storeInitialProductData",value:function(){var e;window.productData||(window.productData={});var t=this.container.dataset.productId;t&&(this.state.productId=t,null!==(e=window.productData[t])&&void 0!==e&&e.initialized?this.config.product=window.productData[t]:window.productData[t]||(window.productData[t]={id:t,variants:[],initialized:!1}))}},{key:"setState",value:function(e){var n=t({},this.state);Object.assign(this.state,e),this.updateUI(e,n)}},{key:"updateUI",value:function(e,t){"isLoading"in e&&this.updateLoadingState(this.state.isLoading),"selectedBox"in e&&this.state.selectedBox!==t.selectedBox&&this.updateSelectedBoxUI(this.state.selectedBox),("selectedFrequency"in e||"sellingPlanId"in e)&&this.updateFrequencyUI()}},{key:"updateSelectedBoxUI",value:function(e){if(e&&this.elements.productActions){var t="subscribe"===e.dataset.purchaseType,n=e.dataset.variant,i=t?e.dataset.subscriptionSellingPlanId:null;this.elements.submitSellingPlanId&&(this.elements.submitSellingPlanId.value=i||""),this.elements.submitVariantId&&(this.elements.submitVariantId.value=n||""),this.elements.sellingPlanInput&&(this.elements.sellingPlanInput.value=i||""),this.setState({sellingPlanId:i,variantId:n,purchaseType:e.dataset.purchaseType,productId:e.dataset.product}),this.elements.purchaseOptionBoxes.forEach((function(t){var n=t===e;t.setAttribute("aria-selected",n?"true":"false");var i=t.querySelector('input[type="radio"]');i&&o(i,"checked",n)})),this.updateBuyButtonTracking(e),this.updatePriceDisplay(e),this.handleFrequencySelectorVisibility(t,e),this.config.isSlideVariant&&this.updateVariantImage(e)}}},{key:"updateFrequencyUI",value:function(){var e,t=this.state.sellingPlanId;if(t){var n=(null===(e=this.elements.frequencyContainer)||void 0===e?void 0:e.dataset.uiType)||"tabs";"tabs"===n&&this.elements.frequencyOptions?this.elements.frequencyOptions.querySelectorAll("div[data-selling-plan-id]").forEach((function(e){var n=e.getAttribute("data-selling-plan-id")===t;e.setAttribute("aria-selected",n?"true":"false")})):"dropdown"===n&&this.elements.frequencyDropdown&&this.elements.frequencyDropdown.value!==t&&(this.elements.frequencyDropdown.value=t),this.updateFrequencyDescription()}}},{key:"updateLoadingState",value:function(e){var t=this.state.loadingButton;if(this.elements.submitButton){var n=e&&"submit"===t;this.elements.submitButton.setAttribute("aria-busy",n?"true":"false"),this.elements.submitButton.disabled=n,this.elements.submitButton.innerHTML=n?'<div class="border-white/20 border-t-white animate-spin inline-block w-6 h-6 mx-auto border-2 rounded-full"></div>':this.elements.submitButton.getAttribute("data-original-text")||"Add To Cart"}if(this.elements.oneTimeButton){var i=e&&"oneTime"===t;this.elements.oneTimeButton.setAttribute("aria-busy",i?"true":"false"),this.elements.oneTimeButton.disabled=i,this.elements.oneTimeButton.innerHTML=i?'<div class="border-primary/20 border-t-primary animate-spin inline-block w-4 h-4 mr-2 align-middle border-2 rounded-full"></div> Adding...':this.elements.oneTimeButton.getAttribute("data-original-text")||"One-Time Purchase"}this.elements.productActions&&this.elements.productActions.setAttribute("data-processing",e?"true":"false")}},{key:"handleFrequencySelectorVisibility",value:function(e,t){this.elements.frequencyContainer&&(e?(c(this.elements.frequencyContainer,"hidden",!1),"none"===this.elements.frequencyContainer.style.display&&(this.elements.frequencyContainer.style.display="block"),this.populateFrequencySelector(t)):c(this.elements.frequencyContainer,"hidden",!0))}},{key:"initState",value:function(){var e,t=this;if(this.elements.productActions&&!(!(null!==(e=this.elements.purchaseOptionBoxes)&&void 0!==e&&e.length)>0)){var n=parseInt(this.elements.productActions.dataset.defaultVariantIndex,10)||0,i=null;n>0&&this.elements.purchaseOptionBoxes.length>=n&&(i=this.elements.purchaseOptionBoxes[n-1]),i||(i=Array.from(this.elements.purchaseOptionBoxes).find((function(e){return"subscribe"===e.dataset.purchaseType}))||this.elements.purchaseOptionBoxes[0]),this.elements.submitButton&&this.elements.submitButton.setAttribute("data-original-text",this.elements.submitButton.textContent),this.elements.oneTimeButton&&this.elements.oneTimeButton.setAttribute("data-original-text",this.elements.oneTimeButton.textContent),i&&(this.state.selectedBox=i,this.state.purchaseType=i.dataset.purchaseType||null,this.state.variantId=i.dataset.variant||null,this.state.productId=i.dataset.product||null,this.state.purchaseType,this.state.sellingPlanId=null,this.updateSelectedBoxUI(i),"subscribe"===this.state.purchaseType&&this.handleFrequencySelectorVisibility(!0,i)),setTimeout((function(){return t.setState({isInitialLoad:!1})}),100)}}},{key:"attachEventListeners",value:function(){var e=this;this.elements.productActions&&(this.elements.productActions.addEventListener("click",(function(t){var n=t.target.closest(".variant-boxes .variant-box");n&&"true"!==n.getAttribute("aria-selected")&&(t.preventDefault(),e.setState({selectedBox:n}))})),this.elements.productActions.addEventListener("keydown",(function(t){if("Enter"===t.key||" "===t.key){var n=t.target.closest(".variant-boxes .variant-box");n&&"true"!==n.getAttribute("aria-selected")&&(t.preventDefault(),e.setState({selectedBox:n}))}})),this.elements.frequencyOptions&&(this.elements.frequencyOptions.addEventListener("click",(function(t){var n=t.target.closest(".frequency-box[data-selling-plan-id]");n&&e.selectFrequencyOption(n)})),this.elements.frequencyOptions.addEventListener("keydown",(function(t){if("Enter"===t.key||" "===t.key){var n=t.target.closest(".frequency-box[data-selling-plan-id]");n&&(t.preventDefault(),e.selectFrequencyOption(n))}}))),this.elements.frequencyDropdown&&this.elements.frequencyDropdown.addEventListener("change",(function(t){e.selectFrequencyOption(t.target.options[t.target.selectedIndex]),t.target.blur()})),this.elements.submitButton&&this.elements.submitButton.addEventListener("click",function(){var t=l(a().m((function t(n){var i,r;return a().w((function(t){for(;;)switch(t.n){case 0:if(n.preventDefault(),!e.state.isLoading&&!e.state.isRedirectingToCheckout){t.n=1;break}return t.a(2);case 1:if(e.setState({isLoading:!0,loadingButton:"submit"}),t.p=2,i=e.prepareItemsForCart()){t.n=3;break}return e.setState({isLoading:!1,loadingButton:null}),t.a(2);case 3:if("buy_now"!==e.config.buyType){t.n=5;break}return t.n=4,e.handleBuyNowFlow(i);case 4:t.n=7;break;case 5:return t.n=6,e.addValidItemsToCart(i);case 6:e.setState({isLoading:!1,loadingButton:null});case 7:t.n=9;break;case 8:t.p=8,r=t.v,console.error("Submit error:",r),m(S(r,"checkout"),"error"),e.setState({isLoading:!1,loadingButton:null});case 9:return t.a(2)}}),t,null,[[2,8]])})));return function(e){return t.apply(this,arguments)}}()),this.elements.oneTimeButton&&this.elements.oneTimeButton.addEventListener("click",function(){var t=l(a().m((function t(n){var i,r,o,s,l,u;return a().w((function(t){for(;;)switch(t.n){case 0:if(n.preventDefault(),!e.state.isLoading&&!e.state.isRedirectingToCheckout){t.n=1;break}return t.a(2);case 1:if(e.setState({isLoading:!0,loadingButton:"oneTime"}),t.p=2,i=e.elements.oneTimeButton.dataset.variantId){t.n=3;break}throw new Error("Invalid variant ID for one-time purchase");case 3:if(r=[{id:parseInt(i,10),quantity:1}],e.config.isOneTimeGift&&((s=e.getSelectedGiftId(!1))&&s.id?(l={id:parseInt(s.id,10),quantity:1,properties:{_gift:"true"}},s.selling_plan_id&&(l.selling_plan=s.selling_plan_id,console.log("Adding one-time gift with selling plan: ".concat(s.selling_plan_id))),r.push(l)):null===(o=e.elements.productActions)||void 0===o||o.dataset.giftsAmount),"buy_now"!==e.config.buyType){t.n=5;break}return t.n=4,e.handleBuyNowFlow(r);case 4:t.n=7;break;case 5:return t.n=6,e.addValidItemsToCart(r);case 6:e.elements.oneTimeButton.innerHTML="✓ Added!",e.elements.oneTimeButton.classList.add("text-green-700","border-green-700"),e.elements.oneTimeButton.classList.remove("text-red-600","border-red-600"),setTimeout((function(){e.setState({isLoading:!1,loadingButton:null}),e.elements.oneTimeButton.classList.remove("text-green-700","border-green-700")}),2e3);case 7:t.n=9;break;case 8:t.p=8,u=t.v,console.error("One-time add error:",u),m(S(u,"cart-add"),"error"),e.elements.oneTimeButton.innerHTML="⚠ Failed",e.elements.oneTimeButton.classList.add("text-red-600","border-red-600"),e.elements.oneTimeButton.classList.remove("text-green-700","border-green-700"),setTimeout((function(){e.setState({isLoading:!1,loadingButton:null}),e.elements.oneTimeButton.classList.remove("text-red-600","border-red-600")}),2e3);case 9:return t.a(2)}}),t,null,[[2,8]])})));return function(e){return t.apply(this,arguments)}}()),document.addEventListener("visibilitychange",(function(){"visible"===document.visibilityState&&setTimeout((function(){e.state.selectedBox&&"subscribe"===e.state.purchaseType&&e.handleFrequencySelectorVisibility(!0,e.state.selectedBox)}),100)})),window.addEventListener("pageshow",(function(t){t.persisted&&e.state.selectedBox&&e.updateSelectedBoxUI(e.state.selectedBox)})))}},{key:"prepareItemsForCart",value:function(){var e;if(!this.state.selectedBox)return m("Please select a purchase option"),null;var n=this.state.variantId,i="subscribe"===this.state.purchaseType,r=i?this.state.sellingPlanId:null;if(!n)return m("Invalid product option selected"),null;if(i&&!r){var a,o=this.findVariantInProductData(n);if(!((null==o||null===(a=o.selling_plan_allocations)||void 0===a?void 0:a.length)>0))return m("Please select a subscription frequency"),null;this.state.sellingPlanId=o.selling_plan_allocations[0].selling_plan.id}var s=[t({id:parseInt(n,10),quantity:1},i&&this.state.sellingPlanId?{selling_plan:this.state.sellingPlanId}:{})];if(parseInt((null===(e=this.elements.productActions)||void 0===e?void 0:e.dataset.giftsAmount)||"0",10)>0){var l=this.getSelectedGiftId(i);if(!l||!l.id)return m("Please select your free gift"),null;var u={id:parseInt(l.id,10),quantity:1,properties:{_gift:"true"}};l.selling_plan_id&&(u.selling_plan=l.selling_plan_id,console.log("Adding gift with selling plan: ".concat(l.selling_plan_id))),s.push(u)}return s}},{key:"getSelectedGiftId",value:function(e){if(!this.elements.giftContainer)return null;var t=this.elements.giftContainer.querySelector(".gift-box.selected");if(!t)return null;var n=t.querySelector(".gift-option-border");if(!n)return null;var i=e?n.dataset.giftIdSubscription:n.dataset.giftId,r=e?n.dataset.giftSellingPlanIdSubscription:n.dataset.giftSellingPlanId;return{id:i,selling_plan_id:r?parseInt(r,10):null}}},{key:"handleBuyNowFlow",value:(n=l(a().m((function e(t){var n,i,o,s,l,u;return a().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,this.setState({isRedirectingToCheckout:!0}),(n=document.getElementById("upCart"))&&n.remove(),e.n=1,k();case 1:return e.n=2,fetch("/cart/add.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:t}),cache:"no-store"});case 2:if((i=e.v).ok){e.n=4;break}return e.n=3,i.json();case 3:throw o=e.v,Object.assign(new Error("Failed to add items for buy now"),{response:o});case 4:return r.invalidate(),e.p=5,e.n=6,w(!0);case 6:s=e.v,console.log("=== CHECKOUT DEBUG INFO ==="),console.log("Cart Items:",s.items),console.log("Item Count:",s.item_count),console.log("Total Price:",s.total_price),console.log("Items Detail:"),s.items.forEach((function(e,t){console.log("Item ".concat(t+1,":"),{title:e.title,variant_title:e.variant_title,quantity:e.quantity,price:e.price,line_price:e.line_price,final_price:e.final_price,discounted_price:e.discounted_price,selling_plan_allocation:e.selling_plan_allocation,variant_id:e.variant_id,sku:e.sku,properties:e.properties})})),console.log("Cart Attributes:",s.attributes),console.log("Original Total Price:",s.original_total_price),console.log("Cart Token:",s.token),console.log("=== END CHECKOUT DEBUG INFO ==="),e.n=8;break;case 7:e.p=7,l=e.v,console.warn("Failed to log checkout debug info:",l);case 8:this.setState({isRedirectingToCheckout:!1,isLoading:!1,loadingButton:null}),setTimeout((function(){window.location.href="/checkout"}),50),e.n=10;break;case 9:throw e.p=9,u=e.v,console.error("handleBuyNowFlow error:",u),this.setState({isRedirectingToCheckout:!1,isLoading:!1,loadingButton:null}),u;case 10:return e.a(2)}}),e,this,[[5,7],[0,9]])}))),function(e){return n.apply(this,arguments)})},{key:"addValidItemsToCart",value:(e=l(a().m((function e(t){var n,i,o,s,l,u,c;return a().w((function(e){for(;;)switch(e.n){case 0:if(e.p=0,!(n=t.find((function(e){return e.selling_plan})))){e.n=3;break}return e.n=1,w(!0);case 1:if(i=e.v,o=n.id,s={},i.items.forEach((function(e){e.selling_plan_allocation&&e.variant_id===o&&(s[e.key]=0)})),!(Object.keys(s).length>0)){e.n=3;break}return e.n=2,fetch("/cart/update.js",{method:"POST",headers:{"Content-Type":"application/json","Cache-Control":"no-cache"},cache:"no-store",body:JSON.stringify({updates:s})});case 2:r.invalidate();case 3:return e.n=4,fetch("/cart/add.js",{method:"POST",headers:{"Content-Type":"application/json","Cache-Control":"no-cache"},cache:"no-store",body:JSON.stringify({items:t})});case 4:if((l=e.v).ok){e.n=6;break}return e.n=5,l.json();case 5:throw u=e.v,Object.assign(new Error("Failed to add items to cart"),{response:u});case 6:return r.invalidate(),"function"==typeof window.updateCart&&window.updateCart(),m("Items added to cart!","success"),e.a(2,l.json());case 7:throw e.p=7,c=e.v,console.error("Error in addValidItemsToCart:",c),c;case 8:return e.a(2)}}),e,null,[[0,7]])}))),function(t){return e.apply(this,arguments)})},{key:"updatePriceDisplay",value:function(e){var t=this;if(this.elements.priceDisplays&&0!==this.elements.priceDisplays.length&&e){parseFloat(e.dataset.subscriptionItemPrice),parseFloat(e.dataset.subscriptionPrice);var n=parseFloat(e.dataset.originalItemCap)||0,i=parseInt(e.dataset.bottleQuantity,10)||1;if(0!==n){var r=n*i,a=parseFloat(e.dataset.subscriptionDiscount)||0,o=parseFloat(e.dataset.firstMonthDiscount)||0,s=(100-(a+o))/100,l=n*s,u=r*s,c=(100-a)/100,d=n*c,p=r*c,h="per_bottle"===this.config.priceFormat?l:u,f="per_bottle"===this.config.priceFormat?n:r,m="per_bottle"===this.config.priceFormat?d:p,y=f-h,v=y/100,b=Math.round(v),g=b>0?"SAVE ".concat(this.state.currencySymbol).concat(b):"",S=function(e){return"".concat(t.state.currencySymbol).concat((e/100).toFixed(2))},w=S(h),q=S(f),k=S(m),I=o>0?"Special price for first order. Refills for ".concat(k).concat("per_bottle"===this.config.priceFormat?"/bottle":"","."):"",E="per_bottle"===this.config.priceFormat&&u!==l?"Total ".concat(S(u/100),' <span class="total-price-cap text-gray-500 line-through">').concat(S(r/100),"</span>"):"";this.elements.priceDisplays.forEach((function(e){var n=e.querySelector(".main-price .price"),i=e.querySelector(".cap"),r=e.querySelector(".discount-badge"),a=e.querySelector(".total-line"),o=e.querySelector(".future-price-notice"),s=e.querySelector(".per-text"),l=n&&n.textContent!==w||i&&i.textContent!==q||r&&r.textContent!==g||a&&a.innerHTML!==E||o&&o.textContent!==I;e.setAttribute("data-price-format",t.config.priceFormat),e.setAttribute("data-has-savings",y>0?"true":"false"),l&&!t.state.isInitialLoad?(e.setAttribute("data-updating","true"),setTimeout((function(){n&&(n.textContent=w),i&&(i.textContent=q),r&&(r.textContent=g,r.setAttribute("data-visible",y>0&&"total"===t.config.priceFormat?"true":"false")),a&&(a.innerHTML=E),o&&(o.textContent=I),s&&(s.style.display="total"===t.config.priceFormat?"none":""),e.setAttribute("data-updating","false")}),220)):(n&&(n.textContent=w),i&&(i.textContent=q),r&&(r.textContent=g,r.setAttribute("data-visible",y>0&&"total"===t.config.priceFormat?"true":"false")),a&&(a.innerHTML=E),o&&(o.textContent=I),s&&(s.style.display="total"===t.config.priceFormat?"none":""))}))}}}},{key:"performSlideUpdate",value:function(e,t){try{if(!e||!t)return;var n=Array.from(e.slides).findIndex((function(e){return e.dataset.variantId===t}));-1!==n&&e.activeIndex!==n&&(e.update(),requestAnimationFrame((function(){e.slideTo(n,300)})))}catch(i){console.error("Swiper slide update error:",i)}}},{key:"updateVariantImage",value:function(e){var t,n=this,i=e.dataset.variant;if(i){var r="productSliderAllInOne".concat(this.config.SID),a=window[r];if(null!==(t=a)&&void 0!==t&&null!==(t=t.slides)&&void 0!==t&&t.length)this.performSlideUpdate(a,i);else var o=0,s=setInterval((function(){var e;null!==(e=a=window[r])&&void 0!==e&&null!==(e=e.slides)&&void 0!==e&&e.length?(clearInterval(s),n.performSlideUpdate(a,i)):++o>=50&&(clearInterval(s),console.warn("Swiper instance ".concat(r," not found after ").concat(50," attempts.")))}),100)}}},{key:"updateBuyButtonTracking",value:function(e){if(this.elements.submitButton&&e){var t=e.dataset.sku,n=e.dataset.purchaseType,r=this.elements.submitButton.getAttribute("name")||"";if(r.startsWith("track:")){var a=r.split("|"),o=a[0],l={};a.slice(1).forEach((function(e){var t=i(e.split(":"),2),n=t[0],r=t[1];n&&(l[n]=r)})),l["variant-sku"]=t,l["purchase-type"]=n;var u="".concat(o,"|").concat(Object.entries(l).map((function(e){var t=i(e,2),n=t[0],r=t[1];return"".concat(n,":").concat(r)})).join("|"));s(this.elements.submitButton,"name",u)}s(this.elements.submitButton,"data-sku",t),s(this.elements.submitButton,"data-purchase-type",n)}}},{key:"selectFrequencyOption",value:function(e){if(e){var t=null,n=null;"string"==typeof e?(t=e,this.elements.frequencyOptions?n=this.elements.frequencyOptions.querySelector('[data-selling-plan-id="'.concat(t,'"]')):this.elements.frequencyDropdown&&(n=Array.from(this.elements.frequencyDropdown.options).find((function(e){return e.value===t})))):1===e.nodeType&&(t=(n=e).dataset.sellingPlanId||n.value),t&&t!==this.state.sellingPlanId&&(this.setState({selectedFrequency:n,sellingPlanId:t}),this.elements.submitSellingPlanId&&(this.elements.submitSellingPlanId.value=t),this.elements.sellingPlanInput&&(this.elements.sellingPlanInput.value=t),this.state.selectedBox&&"subscribe"===this.state.selectedBox.dataset.purchaseType&&(this.state.selectedBox.dataset.subscriptionSellingPlanId=t))}}},{key:"populateFrequencySelector",value:function(e){var t,n=this;if(e&&"subscribe"===e.dataset.purchaseType&&this.elements.frequencyContainer){var i=e.dataset.originalVariant||e.dataset.variant,r=e.dataset.allowedSellingPlans,a=r?r.split(",").map((function(e){return e.trim()})):null,o=this.elements.frequencyContainer.dataset.uiType||"tabs",s="dropdown"===o?this.elements.frequencyDropdown:this.elements.frequencyOptions;if(!s)return console.error("Frequency options container not found for UI type: ".concat(o)),void this.elements.frequencyContainer.classList.add("hidden");s.innerHTML="";var l=this.findVariantInProductData(i);if(null==l||null===(t=l.selling_plan_allocations)||void 0===t||!t.length)return console.warn("No selling plan allocations found for variant ".concat(i,". Hiding frequency selector.")),void this.handleFallbackFrequencyOptions(e,s,this.elements.frequencyContainer);var u=l.selling_plan_allocations;if(a&&0===(u=u.filter((function(e){return a.includes(e.selling_plan.id.toString())}))).length)return console.warn("No selling plans matched the allowed list for variant ".concat(i,":"),r),void this.handleFallbackFrequencyOptions(e,s,this.elements.frequencyContainer);u.sort((function(e,t){var n=E(e.selling_plan.name),i=E(t.selling_plan.name);return("month"===n.unit?30*n.value:"week"===n.unit?7*n.value:n.value)-("month"===i.unit?30*i.value:"week"===i.unit?7*i.value:i.value)}));var c=parseInt(e.dataset.bottleQuantity||"1",10),d=null;if(u.forEach((function(e){var t=E(e.selling_plan.name),n=t.value,i=t.unit;("month"===i&&n===c||1===c&&"day"===i&&30===n||"week"===i&&4===n)&&(d=e.selling_plan.id.toString())})),this.state.isInitialLoad||!this.state.sellingPlanId){var p,f=d||this.state.sellingPlanId||e.dataset.subscriptionSellingPlanId||(null===(p=u[0])||void 0===p?void 0:p.selling_plan.id.toString());this.state.sellingPlanId=f,this.elements.submitSellingPlanId&&(this.elements.submitSellingPlanId.value=f),this.elements.sellingPlanInput&&(this.elements.sellingPlanInput.value=f),e.dataset.subscriptionSellingPlanId=f}else{var m;this.state.sellingPlanId||e.dataset.subscriptionSellingPlanId||d||null===(m=u[0])||void 0===m||m.selling_plan.id.toString()}console.log("populateFrequencySelector: bottleQuantity=".concat(c,", recommendedPlanId=").concat(d,", planIdToSelect=").concat(this.state.sellingPlanId)),u.forEach((function(e){var t=e.selling_plan,i=E(t.name),r=i.value,a=i.unit,l=t.id.toString()===n.state.sellingPlanId,u=t.id.toString()===d;if("dropdown"===o){var c="Every ".concat(r," ").concat(a).concat(r>1?"s":"");u&&(c+=" (Recommended use)");var p=h("option",{value:t.id,textContent:c,selected:l,className:u?"text-primary":"","data-frequency-value":r,"data-frequency-unit":a});s.appendChild(p)}else{var f=h("div",{className:"frequency-box rounded border-2 border-primary-lighter cursor-pointer py-2 px-3 min-w-[90px] max-w-[168px] text-center w-full transition-all duration-300 ease-in-out aria-selected:bg-primary aria-selected:text-white aria-[selected=false]:bg-white aria-[selected=false]:text-primary hover:bg-gray-100","data-selling-plan-id":t.id,"data-frequency-value":r,"data-frequency-unit":a,"aria-selected":l?"true":"false",role:"tab",tabindex:"0",innerHTML:'<span class="font-semibold text-[14px] block">Every '.concat(r,'</span><span class="text-[12px] block">').concat(a).concat(r>1?"s":"","</span>")});s.appendChild(f)}})),"dropdown"===o&&this.elements.frequencyDropdown&&(this.elements.frequencyDropdown.value=this.state.sellingPlanId),this.updateFrequencyDescription(),this.elements.frequencyContainer.classList.remove("hidden")}else this.elements.frequencyContainer&&this.elements.frequencyContainer.classList.add("hidden")}},{key:"handleFallbackFrequencyOptions",value:function(e,t,n){var i=this;if(t&&n){var r=e.dataset.subscriptionSellingPlanId,a=parseInt(e.dataset.bottleQuantity||"1",10);if("subscribe"===e.dataset.purchaseType&&r){t.innerHTML="";var o="dropdown"===(n.dataset.uiType||"tabs"),s=a,l="month";e.dataset.frequencyValue&&e.dataset.frequencyUnit&&(s=parseInt(e.dataset.frequencyValue,10),l=e.dataset.frequencyUnit);var u="Every ".concat(s," ").concat(l).concat(s>1?"s":"");if(o){var c=h("option",{value:r,textContent:u,selected:!0,"data-selling-plan-id":r,"data-frequency-value":s.toString(),"data-frequency-unit":l});t.appendChild(c)}else{var d=h("div",{className:"frequency-box rounded border-2 border-primary-lighter cursor-pointer py-2 px-3 min-w-[90px] max-w-[168px] text-center w-full transition-all duration-300 ease-in-out aria-selected:bg-primary aria-selected:text-white aria-[selected=false]:bg-white aria-[selected=false]:text-primary hover:bg-gray-100","data-selling-plan-id":r,"data-frequency-value":s.toString(),"data-frequency-unit":l,"aria-selected":"true",role:"tab",tabindex:"0",innerHTML:'<span class="font-semibold text-[14px] block">Every '.concat(s,'</span><span class="text-[12px] block">').concat(l).concat(s>1?"s":"","</span>")});t.appendChild(d)}n.classList.remove("hidden"),setTimeout((function(){return i.updateFrequencyDescription()}),50)}else n.classList.add("hidden"),t.innerHTML=""}}},{key:"updateFrequencyDescription",value:function(){var e,t=this;if(this.elements.frequencyDescription&&this.state.selectedBox){var n=(null===(e=this.elements.frequencyContainer)||void 0===e?void 0:e.dataset.uiType)||"tabs";if("dropdown"===n)return this.elements.frequencyDescription.innerHTML="",void(this.elements.frequencyDescription.style.display="none");var i,r,a,o,s,l=this.state.selectedBox,u=parseInt(l.dataset.bottleQuantity||"1",10);if(this.state.sellingPlanId)if("tabs"===n&&this.elements.frequencyOptions&&(s=this.elements.frequencyOptions.querySelector('[data-selling-plan-id="'.concat(this.state.sellingPlanId,'"]'))),null!==(a=s)&&void 0!==a&&a.dataset.frequencyValue&&null!==(o=s)&&void 0!==o&&o.dataset.frequencyUnit)i=parseInt(s.dataset.frequencyValue,10),r=s.dataset.frequencyUnit;else{var c,d=this.findVariantInProductData(this.state.variantId),p=null==d||null===(c=d.selling_plan_allocations)||void 0===c?void 0:c.find((function(e){return e.selling_plan.id.toString()===t.state.sellingPlanId}));if(p){var h=E(p.selling_plan.name);i=h.value,r=h.unit}}var f="";i&&r&&("month"!==r||i!==u)&&(f="Recommended - ".concat(u," month").concat(u>1?"s":"")),this.elements.frequencyDescription.innerHTML!==f&&(this.elements.frequencyDescription.setAttribute("data-changing","true"),setTimeout((function(){t.elements.frequencyDescription.innerHTML=f,setTimeout((function(){t.elements.frequencyDescription.setAttribute("data-changing","false")}),20)}),200))}}},{key:"findVariantInProductData",value:function(e){if(!window.productData||!e)return null;var t=parseInt(e,10),n=window.productData[this.state.productId];if(null!=n&&n.variants){var i=n.variants.find((function(e){return parseInt(e.id,10)===t}));if(i)return i;var r=this.state.selectedBox;if(r&&r.dataset.originalVariant){var a=parseInt(r.dataset.originalVariant,10);if(a===t){var o=parseInt(r.dataset.variant,10);if(i=n.variants.find((function(e){return parseInt(e.id,10)===o})))return i}else if(i=n.variants.find((function(e){return parseInt(e.id,10)===a})))return i}}return console.warn("Variant ".concat(e," not found in product data for product ").concat(this.state.productId)),null}},{key:"moveCtaTextIfNeeded",value:function(){window.innerWidth<768&&this.elements.ctaText&&this.elements.productActions&&this.elements.ctaText.parentElement!==this.elements.productActions&&this.elements.productActions.insertAdjacentElement("afterbegin",this.elements.ctaText)}}],[{key:"getInstance",value:function(e){return T.get(e)}},{key:"getAllInstances",value:function(){return Array.from(T.values())}}]);var e,n}();document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll("[data-buy-box-new-root]").forEach((function(e,t){var n,i={SID:e.dataset.sid,buyType:e.dataset.buyType,priceFormat:e.dataset.priceFormat||"per_bottle",isSlideVariant:"true"===e.dataset.isSlideVariant,isOneTimeGift:"true"===e.dataset.isOneTimeGift,isOneTimePurchaseLink:"true"===e.dataset.isOneTimePurchaseLink,currencySymbol:e.dataset.currencySymbol||"$",product:null===(n=window.productData)||void 0===n?void 0:n[e.dataset.productId]};i.SID&&(!i.product&&e.dataset.productId&&console.warn("BuyBoxNew (".concat(i.SID,"): Product data for ID ").concat(e.dataset.productId," not found in window.productData during initialization.")),new x(e,i))}))})),customElements.get("share-button")||customElements.define("share-button",function(){function e(){var t;return p(this,e),(t=y(this,e)).elements={shareButton:t.querySelector("button"),shareSummary:t.querySelector("summary"),closeButton:t.querySelector(".share-button__close"),successMessage:t.querySelector('[id^="ShareMessage"]'),urlInput:t.querySelector("input")},t.urlToShare=t.elements.urlInput?t.elements.urlInput.value:document.location.href,navigator.share?(t.mainDetailsToggle.setAttribute("hidden",""),t.elements.shareButton.classList.remove("hidden"),t.elements.shareButton.addEventListener("click",(function(){navigator.share({url:t.urlToShare,title:document.title})}))):(t.mainDetailsToggle.addEventListener("toggle",t.toggleDetails.bind(t)),t.mainDetailsToggle.querySelector(".share-button__copy").addEventListener("click",t.copyToClipboard.bind(t)),t.mainDetailsToggle.querySelector(".share-button__close").addEventListener("click",t.close.bind(t))),t}return b(e,DetailsDisclosure),f(e,[{key:"toggleDetails",value:function(){this.mainDetailsToggle.open||(this.elements.successMessage.classList.add("hidden"),this.elements.successMessage.textContent="",this.elements.closeButton.classList.add("hidden"),this.elements.shareSummary.focus())}},{key:"copyToClipboard",value:function(){var e=this;navigator.clipboard.writeText(this.elements.urlInput.value).then((function(){e.elements.successMessage.classList.remove("hidden"),e.elements.successMessage.textContent=window.accessibilityStrings.shareSuccess,e.elements.closeButton.classList.remove("hidden"),e.elements.closeButton.focus()}))}},{key:"updateUrl",value:function(e){this.urlToShare=e,this.elements.urlInput.value=e}}])}());var L=function(e){function t(){var e;return p(this,t),(e=y(this,t)).querySelector("button").addEventListener("click",(function(t){e.expandShowMore(t);var n=t.target.closest(".parent-display").querySelector(".show-more-item");n&&!n.classList.contains("hidden")&&n.querySelector("input").focus()})),e}return b(t,e),f(t,[{key:"expandShowMore",value:function(e){var t=e.target.closest('[id^="Show-More-"]').closest(".parent-display");t.querySelector(".parent-wrap"),this.querySelectorAll(".label-text").forEach((function(e){return e.classList.toggle("hidden")})),t.querySelectorAll(".show-more-item").forEach((function(e){return e.classList.toggle("hidden")}))}}])}(g(HTMLElement));customElements.define("show-more-button",L),console.log("📦 Product bundle loaded - Product page functionality initialized")}}}))}();
