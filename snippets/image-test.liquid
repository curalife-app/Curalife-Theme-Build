{%- comment -%}
  Renders a responsive image using Shopify's image_tag filter
  Accepts:
  - image: {Object} The image object from Shopify (required)
  - max_width: {Number} Maximum width of the image (required)
  - sizes: {String} The sizes attribute for the image (optional)
  - class: {String} CSS class names (optional)
  - lazy: {Boolean} Enable/disable lazy loading (default: true)
  - draggable: {Boolean} Make image draggable (default: false)

  Usage:
  {% render 'responsive-image',
    image: section.settings.image,
    max_width: 1500,
    sizes: "(min-width: 750px) 1500px, 100vw",
    class: "my-custom-class"
  %}
{%- endcomment -%}

{%- liquid
  assign max_width = max_width | default: 2000
  assign sizes = sizes | default: '(min-width: 750px) 1500px, 100vw'
  assign lazy_load = lazy | default: true
  assign draggable = draggable | default: false
  assign loading_attribute = lazy_load | ternary: 'lazy', 'eager'

  # Calculate widths for srcset (1x and 2x versions)
  assign width_1x = max_width
  assign width_2x = max_width | times: 2
  assign widths = width_1x | append: ', ' | append: width_2x
-%}

{%- if image != blank -%}
  {{ image |
    image_url: width: width_2x |
    image_tag:
      loading: loading_attribute,
      widths: widths,
      sizes: sizes,
      class: class,
      draggable: draggable
  }}
{%- else -%}
  {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
{%- endif -%}