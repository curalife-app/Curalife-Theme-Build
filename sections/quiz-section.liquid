{{ 'quiz.js' | asset_url | script_tag }}
{{ 'quiz.css' | asset_url | stylesheet_tag }}

<div
	id="product-quiz"
	class="quiz-main-container"
	data-quiz-url="{{ 'dietitian-quiz.json' | asset_url }}"
	data-n8n-webhook="{{ section.settings.n8n_webhook_url }}"
	data-booking-url="{{ section.settings.booking_url }}">
	<!-- Quiz Intro -->
	<div class="quiz-intro hidden">
		<h2 class="quiz-intro-title">{{ section.settings.title }}</h2>
		<p class="quiz-intro-description">{{ section.settings.description }}</p>
		<button id="quiz-start-button" class="quiz-start-button">
			{{ section.settings.button_text }}
			<svg
				class="quiz-start-icon"
				xmlns="http://www.w3.org/2000/svg"
				width="16"
				height="16"
				viewBox="0 0 24 24"
				fill="none"
				stroke="currentColor"
				stroke-width="2"
				stroke-linecap="round"
				stroke-linejoin="round">
				<path d="M5 12h14M12 5l7 7-7 7"/>
			</svg>
		</button>
	</div>

	<!-- Eligibility Check Indicator -->
	<div class="quiz-eligibility-check hidden">
		<div class="quiz-loading-spinner"></div>
		<h3 class="quiz-eligibility-title">Checking Insurance Eligibility</h3>
		<p class="quiz-eligibility-description">We're verifying your insurance coverage. This may take a moment...</p>
	</div>

	<!-- Error Message -->
	<div class="quiz-error hidden">
		<h3 class="quiz-error-title">Error</h3>
		<p class="quiz-error-description">Failed to load quiz data. Please try again later.</p>
		<button class="quiz-retry-button" onclick="window.location.reload()">Retry</button>
	</div>

	<!-- Navigation Header -->
	<div class="quiz-nav-header hidden" id="quiz-nav-header">
		<div class="quiz-nav-header-content">
			<button class="quiz-back-button" id="quiz-back-button">
				<div class="quiz-back-button-content">
					<svg xmlns="http://www.w3.org/2000/svg" width="104" height="24" viewBox="0 0 104 24" fill="none">
						<path d="M66.8338 18.9354V0H62.4702V17.7084C62.4702 21.9787 64.2818 23.661 69.545 23.661V21.3235C67.4276 21.3235 66.8237 20.7518 66.8237 18.9354M91.0144 13.4812C91.5854 11.0273 93.2884 10.0862 94.9434 10.1191C96.5984 10.152 98.3342 11.0602 98.8699 13.4812H91.0144ZM103.438 15.252C103.438 9.43354 99.307 6.68114 94.9434 6.65079C90.5798 6.62043 86.4815 9.43354 86.4815 15.252C86.4815 21.0705 90.5444 23.8937 94.9434 23.8533C98.9381 23.8204 101.692 21.9711 102.968 18.9126L99.5774 17.501C98.5414 19.6007 96.8991 20.3394 94.9535 20.3723C93.2732 20.4077 91.3605 19.6134 90.9563 16.608H103.337C103.405 16.1626 103.438 15.7127 103.438 15.2621M86.6659 6.85823H83.8486V4.73068C83.8486 2.9143 84.4525 2.3451 86.5699 2.3451V0C81.2967 0 79.4951 1.67977 79.4951 5.95004V6.85823H76.8648V10.3544H79.485V23.6686H83.8486V10.3544H86.6659V6.85823ZM73.2188 0.134078C72.6776 0.134078 72.1485 0.294762 71.6985 0.595809C71.2485 0.896857 70.8978 1.32475 70.6907 1.82537C70.4836 2.32599 70.4294 2.87687 70.535 3.40833C70.6405 3.93979 70.9012 4.42796 71.2839 4.81112C71.6665 5.19428 72.1541 5.45522 72.685 5.56093C73.2158 5.66665 73.766 5.61239 74.266 5.40503C74.766 5.19766 75.1934 4.8465 75.494 4.39595C75.7947 3.9454 75.9552 3.4157 75.9552 2.87383C75.9552 2.1472 75.6669 1.45033 75.1537 0.936532C74.6406 0.42273 73.9445 0.134078 73.2188 0.134078ZM71.0863 23.661H75.4524V6.85823H71.0863V23.661ZM56.7245 15.5657C56.7245 22.768 49.6068 22.6921 49.6068 19.2263C49.6068 15.1559 54.7435 16.6029 56.7245 15.2925V15.5657ZM53.7379 6.75704C50.4785 6.72415 46.4837 8.00169 45.9051 11.9684L50.0363 12.8766C50.4709 10.2203 52.7222 9.95214 53.796 9.95214C55.072 9.95214 56.7169 10.3544 56.7169 12.406C56.7169 15.5657 45.233 11.465 45.233 19.2364C45.233 25.151 53.0911 25.3079 56.7169 21.0832V23.6686H61.083V13.3471C61.083 8.30273 57.3208 6.78992 53.7303 6.76968M45.4807 6.59007H45.415C42.6609 6.59007 40.8138 7.60198 39.74 9.95214V6.85823H35.3738V23.6686H39.74V18.2549C39.74 12.1025 41.6199 10.4126 45.4807 10.4126V6.59007ZM28.9611 12.8083C28.9611 20.5089 25.8709 21.1565 24.696 21.1565C22.8161 21.1565 22.6746 19.2061 22.6746 16.35V6.85823H18.3161V16.3398C18.3161 19.9018 18.7532 23.9292 23.4529 23.9292C25.7041 23.9292 27.6851 22.7857 28.9611 20.2989V23.6686H33.3272V6.85823H28.9611V12.8083ZM8.84346 9.95214C10.8926 9.98503 12.3025 10.8249 13.1389 13.1776L16.7318 11.4295C15.4129 8.00169 12.2217 6.69126 8.84346 6.65584C4.43184 6.62296 0 9.44619 0 15.2621C0 21.0781 4.43184 23.9039 8.84346 23.8634C12.2217 23.8356 15.4129 22.515 16.7217 19.0948L13.1389 17.3467C12.3 19.7019 10.8901 20.5418 8.84346 20.5747C6.56943 20.6076 4.37625 19.3654 4.37625 15.2621C4.37625 11.1588 6.54669 9.91673 8.84346 9.95214Z" fill="#4F4F4F"/>
					</svg>
					<span class="quiz-back-button-text">Back</span>
				</div>
			</button>

			<!-- Logo space - empty for now -->
			<img src="{{ 'logo-new.svg' | asset_url }}" alt="CuraLife Logo" class="quiz-logo">
		</div>
	</div>

	<!-- Progress Bar (separate from header) -->
	<div class="quiz-progress-section hidden" id="quiz-progress-section">
		<div class="quiz-progress-wrapper">
			<div class="quiz-progress-container">
				<div class="quiz-progress-bar"></div>
				<div class="quiz-progress-indicator"></div>
			</div>
		</div>
	</div>

	<!-- Loading Indicator -->
	<div class="quiz-loading hidden">
		<div class="quiz-loading-spinner"></div>
		<p class="quiz-loading-text">Loading quiz...</p>
	</div>

	<!-- Quiz Questions -->
	<div class="quiz-questions hidden">
		<!-- Question Content -->
		<div class="quiz-question-container">
			<!-- Question will be inserted here by JavaScript -->
		</div>

		<!-- Navigation -->
		<div class="quiz-navigation">
			<button class="quiz-nav-button quiz-nav-button--secondary hidden" id="quiz-prev-button">Back</button>
			<button class="quiz-nav-button quiz-nav-button--primary" id="quiz-next-button">Next</button>
		</div>
	</div>

	<!-- Results Section -->
	<div class="quiz-results hidden">
		<!-- Results content will be injected here by JavaScript -->
	</div>
</div>

{% schema %}
	{
		"name": "Dietitian Quiz",
		"settings": [
			{
				"type": "text",
				"id": "title",
				"label": "Quiz Title",
				"default": "Find Your Perfect Dietitian"
			},
			{
				"type": "textarea",
				"id": "description",
				"label": "Quiz Description",
				"default": "Answer a few quick questions so we can match you with the right registered dietitian, confirm your insurance benefits, and help you pay $0 out-of-pocket."
			},
			{
				"type": "text",
				"id": "button_text",
				"label": "Start Button Text",
				"default": "Start Quiz"
			},
			{
				"type": "text",
				"id": "booking_url",
				"label": "Appointment Booking URL",
				"default": "/appointment-booking",
				"info": "Where to send users after completing the quiz"
			},
			{
				"type": "text",
				"id": "n8n_webhook_url",
				"label": "Webhook URL",
				"default": "https://us-central1-telemedicine-458913.cloudfunctions.net/telemedicine-webhook",
				"info": "URL to send quiz responses to the telemedicine workflow"
			}
		],
		"presets": [
			{
				"name": "Dietitian Quiz",
				"category": "Interactive"
			}
		]
	}
{% endschema %}
