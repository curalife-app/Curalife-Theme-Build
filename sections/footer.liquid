{% unless section.settings.hide_on_affiliate_pages and request.path contains '-aff' %}
  {%- # Cache commonly used values -%}
  {%- assign current_year = 'now' | date: '%Y' -%}
  {%- assign shop_name = shop.name -%}

  <footer class="bg-primary text-footer-custom" style="--footer-text-color: {{ section.settings.text_color }}; --footer-titles-color: {{ section.settings.titles_color }};">
    <div class="top-info py-8">
      <div class="container mx-auto px-4">
        <div class="flex justify-between">
          {%- # Main Column -%}
          <div class="footer-column md:w-auto pt-5">
            <a href="/" class="block">
              {%- # Use native lazy loading and exact dimensions -%}
              <img
                class="logo invert max-w-[150px]"
                src="{{ 'logo-new.svg' | asset_url }}"
                alt="{{ shop_name }} logo"
                width="134"
                height="32"
                loading="lazy"
                decoding="async">
            </a>

            {%- # Social Links -%}
            <div class="social-links flex gap-4 text-2xl mt-4">
              {%- for block in section.blocks -%}
                {%- if block.type == 'social' and block.settings.social_link != blank -%}
                  <a
                    href="{{ block.settings.social_link }}"
                    target="_blank"
                    rel="noopener noreferrer"
                    aria-label="Visit our {{ block.settings.social_icon_class | remove: 'fa-' | remove: 'fab' | capitalize }}">
                    <i class="{{ block.settings.social_icon_class }} text-white"></i>
                  </a>
                {%- endif -%}
              {%- endfor -%}
            </div>
          </div>

          {%- # Menu Column -%}
          <div class="footer-column w-full md:w-4/5 pt-5">
            <div class="menu-list flex flex-wrap justify-between gap-5">
              {%- for block in section.blocks -%}
                {%- if block.type == 'menu' and block.settings.footer_linklist != blank -%}
                  {%- assign footer_linklist = block.settings.footer_linklist -%}
                  {%- if linklists[footer_linklist].links.size > 0 -%}
                    <div class="menu-wrapper flex flex-col gap-2.5">
                      <h2 class="h6 text-[--footer-titles-color] uppercase font-bold">{{ block.settings.menu_title }}</h2>
                      <nav class="menu flex flex-col gap-4">
                        {%- for link in linklists[footer_linklist].links -%}
                          <a
                            href="{{ link.url }}"
                            class="font-light text-[16px] text-white hover:opacity-80 transition-opacity"
                            {%- if link.url contains 'professionals' or link.url contains 'retail' -%}
                              rel="nofollow"
                            {%- endif -%}>
                            {{ link.title }}
                          </a>
                        {%- endfor -%}
                      </nav>
                    </div>
                  {%- endif -%}
                {%- endif -%}
              {%- endfor -%}
            </div>
          </div>
        </div>

        {%- # Disclaimer -%}
        {%- if section.settings.disclaimer != blank -%}
          <div class="mt-5 text-xs text-white/70">{{ section.settings.disclaimer }}</div>
        {%- endif -%}
      </div>
    </div>

    {%- # Footer Bottom -%}
    <div class="bottom-info py-2.5 border-t border-white/40">
      <div class="container mx-auto px-4">
        <div class="flex text-white items-center justify-between text-xs">
          <p>&copy; {{ current_year }} {{ shop_name }}</p>

          {%- # Payment Methods -%}
          <div class="flex gap-5">
            {%- for block in section.blocks -%}
              {%- if block.type == 'payment' and block.settings.payment_img != blank -%}
                <img
                  src="{{ block.settings.payment_img | img_url: '51x32' }}"
                  width="51"
                  height="32"
                  alt="Payment method"
                  loading="lazy"
                  decoding="async">
              {%- endif -%}
            {%- endfor -%}
          </div>

          <p>All Rights Reserved</p>
        </div>
      </div>
    </div>
  </footer>
{% endunless %}

{%- # Styles - Consider moving to a separate CSS file -%}
<style>
  footer {
    --footer-titles-color: {{ section.settings.titles_color }};
  }

  @media screen and (max-width: 768px) {
    .menu-list {
      flex-direction: column;
      gap: 5vw;
    }

    .pre-bottom-text {
      font-size: 3vw;
      line-height: 1.8em;
    }

    .copy-write,
    .rights-reserved {
      font-size: 2vw;
      margin-left: 2vw;
    }
  }
</style>

{% schema %}
{
  "name": "Footer",
  "class": "footer_section",
  "settings": [
    {
      "type": "color",
      "id": "bg_color",
      "label": "Background Color"
    },
    {
      "type": "color",
      "id": "titles_color",
      "label": "Titles Color"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#ffffff"
    },
    {
      "type": "image_picker",
      "id": "logo_img",
      "label": "Logo image"
    },
    {
      "type": "richtext",
      "id": "disclaimer",
      "label": "Disclaimer"
    },
    {
      "type": "checkbox",
      "id": "hide_on_affiliate_pages",
      "label": "Hide on affiliate pages"
    }
  ],
  "blocks": [
    {
      "type": "menu",
      "name": "Menu",
      "settings": [
        {
          "type": "text",
          "id": "menu_title",
          "label": "Heading"
        },
        {
          "type": "link_list",
          "id": "footer_linklist",
          "label": "Menu"
        }
      ]
    },
    {
      "type": "social",
      "name": "Social Media",
      "settings": [
        {
          "type": "text",
          "id": "social_icon_class",
          "label": "Social Icon Class"
        },
        {
          "id": "social_link",
          "type": "url",
          "label": "Social Icon Link"
        }
      ]
    },
    {
      "type": "payment",
      "name": "Payment Images",
      "settings": [
        {
          "type": "image_picker",
          "id": "payment_img",
          "label": "Select Payment Image"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Footer"
    }
  ]
}
{% endschema %}