{% comment %}
	SECTION: accordion-component.liquid
	Purpose:
		- Left half: Full-height background image with a headline + optional subheading overlaid.
		- Right half: A white card with an accordion listing multiple "Month X" items.
{% endcomment %}

<section id="accordion-component" style="
	width: 100%;
	max-width: 1200px;
	margin: 0 auto;
	display: flex;
	flex-wrap: wrap;
	align-items: stretch;
	justify-content: space-between;
">

	<!-- LEFT COLUMN (Background Image + Text Overlay) -->
	<div class="image-column" style="
		flex: 1 1 50%;
		position: relative;
		min-height: 500px; /* ensures a decent vertical space */
		background-size: cover;
		background-position: center center;
		{% if section.settings.background_image != blank %}
			background-image: url('{{ section.settings.background_image | image_url: width:1600 }}');
		{% else %}
			background-color: #ccc; /* fallback if no image is uploaded */
		{% endif %}
	">
		<!-- Optional gradient overlay for better text contrast -->
		<div style="
			position: absolute;
			top: 0; left: 0;
			width: 100%; height: 100%;
			background: linear-gradient(to bottom, rgba(0,0,0,0.1), rgba(0,0,0,0.4));
		"></div>

		<div class="text-overlay" style="
			position: absolute;
			bottom: 2rem;
			left: 2rem;
			color: #fff;
			z-index: 2;
			max-width: 80%;
		">
			{% if section.settings.heading != blank %}
				<h2 style="
					margin: 0 0 0.5rem;
					font-size: 2rem;
					line-height: 1.2;
				">
					{{ section.settings.heading }}
				</h2>
			{% endif %}

			{% if section.settings.subheading != blank %}
				<p style="
					margin: 0;
					font-size: 1.125rem;
					line-height: 1.4;
				">
					{{ section.settings.subheading }}
				</p>
			{% endif %}
		</div>
	</div>

	<!-- RIGHT COLUMN (Accordion Card) -->
	<div class="accordion-column" style="
		flex: 1 1 45%;
		display: flex;
		align-items: center;
		justify-content: center;
		padding: 2rem 1rem;
	">
		<div class="accordion-card" style="
			width: 100%;
			background: #fff;
			border-radius: 8px;
			box-shadow: 0 2px 12px rgba(0,0,0,0.08);
			padding: 2rem;
		">
			{% for block in section.blocks %}
				{% if block.type == 'accordion_item' %}
					<div class="accordion-item" style="
						border-bottom: 1px solid #eee;
						padding: 1rem 0;
					">
						<div class="accordion-header" style="
							cursor: pointer;
							display: flex;
							justify-content: space-between;
							align-items: center;
						">
							<span style="font-weight: bold; font-size: 1rem;">
								{{ block.settings.month_title }}
							</span>
							<span class="accordion-icon" style="
								margin-left: 1rem;
								font-weight: bold;
								font-size: 1.2rem;
							">
								+
							</span>
						</div>
						<div class="accordion-content" style="
							overflow: hidden;
							max-height: 0;
							transition: max-height 0.3s ease;
							margin-top: 0.5rem;
						">
							{% if block.settings.subtitle != blank %}
								<h4 style="
									margin: 0 0 0.5rem;
									font-size: 1rem;
									font-weight: normal;
								">
									{{ block.settings.subtitle }}
								</h4>
							{% endif %}
							<p style="margin: 0; font-size: 0.95rem; line-height: 1.5;">
								{{ block.settings.description }}
							</p>
						</div>
					</div>
				{% endif %}
			{% endfor %}
		</div>
	</div>

</section>

<!-- JavaScript for Accordion Toggle -->
<script>
document.addEventListener('DOMContentLoaded', function() {
	var accordionComponent = document.getElementById('accordion-component');
	if (!accordionComponent) return;

	var accordionHeaders = accordionComponent.querySelectorAll('.accordion-header');

	accordionHeaders.forEach(function(header) {
		header.addEventListener('click', function() {
			var parentItem = header.parentElement;
			var content = parentItem.querySelector('.accordion-content');
			var icon = header.querySelector('.accordion-icon');

			// Close other open items so only one is open at a time
			var allContents = accordionComponent.querySelectorAll('.accordion-content');
			allContents.forEach(function(otherContent) {
				if (otherContent !== content) {
					otherContent.style.maxHeight = null;
					var otherIcon = otherContent.parentElement.querySelector('.accordion-icon');
					if (otherIcon) otherIcon.textContent = '+';
				}
			});

			// Toggle the clicked item
			if (content.style.maxHeight && content.style.maxHeight !== '0px') {
				content.style.maxHeight = '0px';
				icon.textContent = '+';
			} else {
				content.style.maxHeight = content.scrollHeight + 'px';
				icon.textContent = '-';
			}
		});
	});
});
</script>

{% schema %}
{
	"name": "Accordion",
	"settings": [
		{
			"type": "text",
			"id": "heading",
			"label": "Main Heading",
			"default": "Your Journey: Shed Pounds & Feel Great"
		},
		{
			"type": "text",
			"id": "subheading",
			"label": "Subheading",
			"default": "Add a motivating line or supporting text here."
		},
		{
			"type": "image_picker",
			"id": "background_image",
			"label": "Background Image"
		}
	],
	"blocks": [
		{
			"type": "accordion_item",
			"name": "Accordion Item",
			"settings": [
				{
					"type": "text",
					"id": "month_title",
					"label": "Month Title",
					"default": "Month 3"
				},
				{
					"type": "text",
					"id": "subtitle",
					"label": "Subtitle",
					"default": "Getting Started"
				},
				{
					"type": "textarea",
					"id": "description",
					"label": "Description",
					"default": "Take the product twice a day to establish a routine. Consistent use will help reduce cravings and build healthy habits."
				}
			]
		}
	],
	"max_blocks": 12,
	"presets": [
		{
			"name": "Accordion"
		}
	]
}
{% endschema %}
