{%- comment -%} If store is US {%- endcomment -%}
{% if shop.name == 'CuraLife' %}
	{% assign invoice_id = '51da85a3c3dfa1f360b48852b64218b2' %}
	{% assign manage_subscription_url = '/tools/recurring/login' %}
{% elsif shop.name == 'CuraLife Global' %}
	{% assign invoice_id = '656f0dbf9392657eed7feefc486781fb' %}
	{% assign manage_subscription_url = '/pages/manage-my-subscriptions' %}
{% endif %}

{% if customer.tags contains 'curalifer' %}
	{% assign show_curalifer_tab = true %}
{% endif %}

<section class="account-page bg-gradient-to-b from-[#f8f9fa] to-[#e9ecef] min-h-screen py-16">
	<div class="max-w-7xl container px-4 mx-auto">
		<h1 class="mb-12 text-4xl font-bold text-center text-gray-800">Welcome Back, {{ customer.first_name }}!</h1>
		<div id="tabs">
			<div class="account-content lg:flex-row flex flex-col gap-8">
				<div class="account-menu desktop lg:w-1/3">
					<nav class="rounded-2xl backdrop-blur-lg bg-opacity-90 p-6 bg-white border border-gray-100 shadow-lg">
						<h2 class="mb-6 text-xl font-semibold text-gray-700">Account Navigation</h2>
						<ul class="tabs space-y-3">
							{% if show_curalifer_tab %}
								<li class="tab">
									<a href="#curalifer" class="hover:bg-primary-50 hover:text-primary-600 rounded-xl group flex items-center p-4 transition-all">
										<span class="material-icons group-hover:text-primary-500 mr-3 text-gray-400">person</span>
										<span class="font-medium">Curalifer</span>
									</a>
								</li>
							{% endif %}
							<li class="tab">
								<a href="#a" class="hover:bg-primary-50 hover:text-primary-600 rounded-xl group flex items-center p-4 transition-all">
									<span class="material-icons group-hover:text-primary-500 mr-3 text-gray-400">account_circle</span>
									<span class="font-medium">My Profile</span>
								</a>
							</li>
							<li class="tab">
								<a href="#b" class="hover:bg-primary-50 hover:text-primary-600 rounded-xl group flex items-center p-4 transition-all">
									<span class="material-icons group-hover:text-primary-500 mr-3 text-gray-400">shopping_bag</span>
									<span class="font-medium">Orders</span>
								</a>
							</li>
							<li class="tab">
								<a href="#e" class="hover:bg-primary-50 hover:text-primary-600 rounded-xl group flex items-center p-4 transition-all">
									<span class="material-icons group-hover:text-primary-500 mr-3 text-gray-400">loyalty</span>
									<span class="font-medium">Loyalty</span>
								</a>
							</li>
							<li class="tab">
								<a href="#f" class="hover:bg-primary-50 hover:text-primary-600 rounded-xl group flex items-center p-4 transition-all">
									<span class="material-icons group-hover:text-primary-500 mr-3 text-gray-400">lock</span>
									<span class="font-medium">Change Password</span>
								</a>
							</li>
							<li>
								<a href="{{ manage_subscription_url }}" class="hover:bg-primary-50 hover:text-primary-600 rounded-xl group flex items-center p-4 transition-all">
									<span class="material-icons group-hover:text-primary-500 mr-3 text-gray-400">sync</span>
									<span class="font-medium">Subscriptions</span>
								</a>
							</li>
							<li class="pt-6 mt-6 border-t">
								<a href="/account/logout" class="hover:bg-red-50 hover:text-red-600 rounded-xl group flex items-center p-4 text-gray-600 transition-all">
									<span class="material-icons group-hover:text-red-500 mr-3 text-gray-400">logout</span>
									<span class="font-medium">Logout</span>
								</a>
							</li>
						</ul>
					</nav>
				</div>

				<div class="account-menu-mobile lg:hidden mb-8">
					<div class="relative">
						<select
							id="mobile-dropdown"
							class="rounded-xl backdrop-blur-lg bg-opacity-90 w-full p-5 font-medium text-gray-700 bg-white border border-gray-100 shadow-lg appearance-none cursor-pointer"
							onchange="changeContent()">
							{% if show_curalifer_tab %}
								<option value="#curalifer">Curalifer</option>
							{% endif %}
							<option value="#a">My Profile</option>
							<option value="#b">Orders</option>
							<option value="#e">Loyalty</option>
							<option value="#f">Change Password</option>
							<option value="{{ manage_subscription_url }}">Subscriptions</option>
							<option value="/account/logout/">Logout</option>
						</select>
						<div class="right-4 top-1/2 absolute transform -translate-y-1/2 pointer-events-none">
							<span class="material-icons text-gray-400">expand_more</span>
						</div>
					</div>
				</div>

				<div class="account-data lg:w-2/3">
					{% if show_curalifer_tab %}
						<div class="data-row" id="curalifer">
							<div class="rounded-xl p-6 mb-6 bg-white shadow-sm">
								<h2 class="mb-2 text-2xl font-bold">My Curalife</h2>
								<p class="mb-6 text-gray-600">Your exclusive access to our recipes and workouts to help you live a healthier life.</p>

								<div class="md:grid-cols-2 grid gap-6">
									<a href="/blogs/recipes" class="group block">
										<div class="relative overflow-hidden rounded-lg">
											<img
												src="https://cdn.shopify.com/s/files/1/0452/2459/1511/files/curalifer_recipies.png"
												alt="Curalife Recipes"
												class="group-hover:scale-105 object-cover w-full h-48 transition-transform duration-300 transform">
											<div class="bg-opacity-40 absolute inset-0 flex items-center justify-center bg-black">
												<h5 class="text-xl font-bold text-white">Recipes</h5>
											</div>
										</div>
									</a>

									<a href="/blogs/workouts" class="group block">
										<div class="relative overflow-hidden rounded-lg">
											<img
												src="https://cdn.shopify.com/s/files/1/0452/2459/1511/files/curalifer_exercise.png"
												alt="Curalife Workouts"
												class="group-hover:scale-105 object-cover w-full h-48 transition-transform duration-300 transform">
											<div class="bg-opacity-40 absolute inset-0 flex items-center justify-center bg-black">
												<h5 class="text-xl font-bold text-white">Workouts</h5>
											</div>
										</div>
									</a>
								</div>
							</div>
						</div>
					{% endif %}

					<div class="data-row" id="a">
						<div class="md:grid-cols-2 grid gap-6">
							<div class="rounded-xl overflow-hidden bg-white shadow-sm">
								<div class="bg-primary-600 p-4">
									<h5 class="text-lg font-bold text-white">Contact Information</h5>
								</div>
								<div class="p-6">
									<div class="space-y-4">
										<div class="flex items-center justify-between pb-3 border-b">
											<span class="text-gray-600">First Name</span>
											<span class="font-semibold">{{ customer.first_name }}</span>
										</div>
										<div class="flex items-center justify-between pb-3 border-b">
											<span class="text-gray-600">Last Name</span>
											<span class="font-semibold">{{ customer.last_name }}</span>
										</div>
										<div class="flex items-center justify-between pb-3">
											<span class="text-gray-600">Email</span>
											<span class="font-semibold">{{ customer.email }}</span>
										</div>
									</div>
									<div class="mt-6">
										<a href="/account/addresses" class="bg-primary-600 hover:bg-primary-700 block w-full px-4 py-3 font-semibold text-center text-white transition-colors rounded-lg">
											Edit Information
										</a>
									</div>
								</div>
							</div>

							<div class="rounded-xl overflow-hidden bg-white shadow-sm">
								<div class="bg-primary-600 p-4">
									<h5 class="text-lg font-bold text-white">Shipping Address</h5>
								</div>
								<div class="p-6">
									{% assign address = customer.default_address %}
									{% if address %}
										<div class="mb-6 space-y-2">
											<p class="font-semibold">
												{{ address.first_name }}
												{{ address.last_name }}
											</p>
											{% if address.company != blank %}
												<p>{{ address.company }}</p>
											{% endif %}
											{% if address.street != blank %}
												<p>{{ address.street }}</p>
											{% endif %}
											<p>
												{{ address.city }}
												{% if address.province_code != blank %}, {{ address.province_code }}{% endif %}
											</p>
											<p>
												{{ address.country }}
												{{ address.zip }}
											</p>
											{% if address.phone != blank %}
												<p>{{ address.phone }}</p>
											{% endif %}
										</div>
									{% else %}
										<div class="flex items-center justify-center h-32 text-gray-500">
											<span class="material-icons mr-2">local_shipping</span>
											<p>You don't have a shipping address yet.</p>
										</div>
									{% endif %}
									<div class="mt-6">
										<a href="/account/addresses" class="bg-primary-600 hover:bg-primary-700 block w-full px-4 py-3 font-semibold text-center text-white transition-colors rounded-lg">
											{% if address %}Update{% else %}Add{% endif %}
											Address
										</a>
									</div>
								</div>
							</div>
						</div>
					</div>

					<div class="data-row w-full" id="b">
						<div class="rounded-xl overflow-hidden bg-white shadow-lg">
							<div class="bg-primary-600 p-4">
								<h5 class="text-lg font-bold text-white">Order History</h5>
							</div>
							<div class="p-6">
								{% render 'account-orders' %}
							</div>
						</div>
					</div>

					<div class="data-row" id="e">
						<div class="rounded-xl overflow-hidden bg-white shadow-lg">
							<div class="bg-primary-600 p-4">
								<h5 class="text-lg font-bold text-white">Loyalty Program</h5>
							</div>
							<div class="p-6">
								{% render 'account-rewards' %}
							</div>
						</div>
					</div>

					<div class="data-row" id="f">
						<div class="rounded-xl overflow-hidden bg-white shadow-lg">
							<div class="bg-primary-600 p-4">
								<h5 class="text-lg font-bold text-white">Change Password</h5>
							</div>
							<div class="p-6">
								{% render 'account-change-password' %}
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>

<style>
	main {
		--primary: var(--curalin);

		background: var(--beige);
	}

	section:has(.rc-login) {
		padding: 0;
	}
	.rc-login a {
		display: inline-flex;
		padding: 10px 20px;
		background: var(--blue);
		color: white;
		font-weight: bold;
		border-radius: 5px;
	}
</style>

<style>
	.account-page li:before {
		display: none;
	}

	.account-data {
		position: relative;
	}

	#mobile-dropdown {
		width: 100%;
		background: white;
		padding: 10px;
		font-weight: bold;
		box-shadow: 1px 4px 18px -16px rgba(0, 0, 0, 0.75);
	}

	.data-row {
		position: absolute;
		opacity: 0;
		transition: opacity 0.5s ease;
	}

	.data-row.active {
		opacity: 1;
	}

	.account-content {
		display: flex;
		gap: 30px;
	}

	.account-menu {
		width: 300px;
		border-radius: 10px;
	}

	.account-menu .menu-list .tabs {
		display: flex;
		flex-direction: column;
		gap: 10px;
	}

	.account-menu .menu-list .tabs .tab.active {
		background-color: var(--primary); /* Use primary color for active tab */
		color: white; /* White text for active tab */
		font-weight: 600; /* Bold font for active tab */
		border-bottom: 2px solid var(--primary); /* Add border to active tab */
		box-shadow: unset;
	}
	.account-menu .menu-list .tabs .tab:hover {
		background-color: #f0f0f0; /* Light gray on hover for non-active tabs */
		box-shadow: unset;
	}
	.account-menu .menu-list .tabs .tab {
		border-bottom: 1px solid #e0e0e0; /* Add border to inactive tabs */
		padding: 15px 20px; /* Adjust padding */
		margin-bottom: 5px; /* Adjust margin */
	}

	.account-data {
		width: -webkit-fill-available;
	}

	.account-data .data-row {
		display: flex;
		flex-wrap: wrap;
		gap: 20px;
	}

	.account-data .data-row .data-wrap {
		display: flex;
		flex-direction: column;
		min-width: 390px;
		border-radius: 10px;
		background: white;
		box-shadow: 1px 4px 18px -16px rgba(0, 0, 0, 0.75);
		margin-bottom: 20px; /* Add margin between data wraps */
	}

	.account-data .data-title {
		padding: 16px 15px;
		text-align: center;
		font-weight: bold;
		font-size: 20px;
		background: var(--primary); /* Add primary color background */
		color: white; /* White text */
		border-radius: 10px 10px 0 0; /* Round top corners */
		margin: 0; /* Remove margin */
	}

	.account-data .data-content {
		display: flex;
		flex-direction: column;
		justify-content: space-between;
		flex: 1;
		padding: 30px;
		background: #f9f9f9; /* Add light gray background */
		border-radius: 0 0 10px 10px; /* Round bottom corners */
	}

	.contact-info ul li:first-child {
		padding-top: 0;
	}
	.contact-info ul li {
		display: block;
		padding: 15px 0;
	}

	.account-page ul li {
		padding-left: unset;
	}

	.account-page ul li::before {
		content: '';
	}

	.main-btn {
		display: inline-flex;
		justify-content: center;
		align-items: center;
		letter-spacing: 2px;
		text-transform: uppercase;
		color: #fff;
		background: var(--blue);
		border-radius: 5px; /* Increase border radius */
		min-height: 50px;
		width: -webkit-fill-available;
		transition: all 0.3s ease; /* Add transition */
		font-weight: 600; /* Make text bolder */
	}

	.main-btn:hover {
		background: var(--primary); /* Change color on hover */
		transform: translateY(-2px); /* Add slight lift effect */
		box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Add shadow on hover */
	}

	.account-menu .menu-list .tabs .tab {
		padding-left: unset;
	}

	.account-menu .menu-list .tabs .tab a span {
		display: flex;
		min-width: 25px;
	}

	.account-menu .menu-list .tabs .tab a,
	.account-menu .menu-list .tabs .tab:last-child {
		display: flex;
		align-items: center;
		color: inherit;
		transition: all 0.3s ease;
		gap: 10px;
		background: white;
		padding: 20px;
		border-radius: 10px;
		box-shadow: 1px 4px 18px -16px rgba(0, 0, 0, 0.75);
	}

	.account-menu .menu-list .tabs .tab a:hover,
	.account-menu .menu-list .tabs .tab:last-child:hover {
		transform: translateX(5px);
		background: #f9f9f9;
	}

	.contact-info ul li p span {
		display: block;
		padding-left: 15px;
		font-weight: 700;
		font-size: 16px;
		text-transform: uppercase;
		color: var(--primary); /* Use primary color for values */
	}

	.contact-info ul li {
		display: block;
		padding: 15px 0;
		min-width: 300px;
		border-bottom: 1px solid #efefef;
	}

	.contact-info ul li:first-child {
		padding-top: 0;
	}

	.contact-info ul li p {
		display: flex;
		flex-wrap: wrap;
		justify-content: space-between;
		margin: 0;
		font-weight: 400;
		font-size: 14px;
		line-height: 1.29;
		color: var(--dark);
	}

	.account-data .form-text {
		text-align: center;
	}

	.form-fields {
		display: flex;
		flex-wrap: wrap;
	}

	.form-fields label.full-size {
		width: 100%;
	}

	.form-fields label {
		display: block;
		margin: 10px;
		position: relative;
	}

	.form-fields label input {
		width: 100%;
		padding: 17px 21px;
		font-weight: 400;
		font-size: 16px;
		line-height: 1.5;
		color: #737373;
		background: #fff;
		border: 2px solid #ebebeb;
		box-sizing: border-box;
		border-radius: 5px;
		transition: all 0.3s ease;
	}

	.form-fields label input:focus {
		border-color: var(--primary);
		outline: none;
		box-shadow: 0 0 0 3px rgba(var(--primary-rgb), 0.1);
	}

	.form-wrap {
		max-width: 600px;
		margin: auto;
		text-align: center;
	}

	@media screen and (max-width: 1200px) {
		.account-menu .menu-list .tabs .tab {
			margin: 5px 0;
			padding-left: 16px;
			font-size: 14px;
		}

		.account-data {
			width: calc(100% - 230px);
			padding-left: 10px;
		}

		.account-data .data-title {
			padding: 13px 15px;
		}
		.account-data .data-title h3 {
			font-size: 14px;
		}
		.account-data .data-content {
			padding: 22px 19px;
		}
		.contact-info ul li {
			padding: 12px 0;
		}

		.contact-info ul li {
			padding: 12px 0;
		}
	}

	@media screen and (max-width: 768px) {
		.account-menu {
			width: 100%;
		}

		.account-menu .menu-list .tabs .tab {
			margin: unset;
			gap: 5px;
			padding-left: 25px;
			font-size: 16px;
		}

		.account-data {
			width: 100%;
			padding-left: 0;
			margin-top: 18px;
		}
		.account-data .data-row .data-wrap {
			min-width: -webkit-fill-available;
			margin: unset;
		}
		.account-data .data-title {
			padding: 16px 15px;
		}
		.account-data .data-title h3 {
			font-size: 16px;
		}
		.account-data .data-content {
			padding: 20px 12px;
		}
		.contact-info {
			padding: 0 8px 14px;
		}
		.contact-info ul li:first-child {
			padding-top: 12px;
			border-top: 1px solid #efefef;
		}

		.contact-info ul li p span {
			font-size: 16px;
		}
		.contact-info ul li:first-child {
			padding-top: 12px;
			border-top: 1px solid #efefef;
		}
		.contact-info ul li p {
			font-size: 14px;
		}

		.account-content {
			flex-wrap: wrap;
		}
	}
</style>

<script>
	document.addEventListener('DOMContentLoaded', () => {
		// Cache DOM elements
		const elements = {
			accountData: document.querySelector('.account-data'),
			tabs: document.querySelector('#tabs'),
			mobileDropdown: document.querySelector('#mobile-dropdown')
		};

		// Early return if required elements are missing
		if (!elements.accountData || !elements.tabs || !elements.mobileDropdown) {
			console.error('Required elements not found');
			return;
		}

		// Cache tab-related elements
		const tabElements = {
			links: [...elements.tabs.querySelectorAll('.tabs .tab a')],
			panes: [...elements.tabs.querySelectorAll('.account-data .data-row')]
		};

		// Helper functions
		const updateTabPane = tabPane => {
			if (!tabPane) return;

			const tabPaneWrap = tabPane.querySelector('.data-wrap');
			if (tabPaneWrap) {
				elements.accountData.style.height = `${tabPaneWrap.offsetHeight}px`;
			}
		};

		const resetTabs = () => {
			tabElements.panes.forEach(pane => {
				pane.classList.remove('active');
				pane.style.pointerEvents = 'none';
			});
			tabElements.links.forEach(link => link.parentElement.classList.remove('active'));
		};

		const setActiveTab = targetLink => {
			if (!targetLink) return;

			resetTabs();

			const href = targetLink.getAttribute('href')?.substr(1);
			const tabPane = href ? document.getElementById(href) : null;

			if (tabPane) {
				tabPane.classList.add('active');
				tabPane.style.pointerEvents = 'auto';
				updateTabPane(tabPane);
			}

			targetLink.parentElement.classList.add('active');
		};

		// Event handlers
		const handleTabClick = e => {
			e.preventDefault();
			setActiveTab(e.target);
		};

		const handleTransitionEnd = () => {
			const activePane = elements.tabs.querySelector('.data-row.active');
			if (activePane) {
				elements.accountData.style.height = `${activePane.clientHeight}px`;
			}
		};

		const handleMobileDropdown = e => {
			const value = e.target.value;
			if (value.charAt(0) !== '#') {
				window.location.href = value;
				return;
			}

			const tabLink = elements.tabs.querySelector(`.tabs .tab a[href="${value}"]`);
			if (tabLink) {
				setActiveTab(tabLink);
			}
		};

		// Initialize and attach event listeners
		if (tabElements.links.length) {
			setActiveTab(tabElements.links[0]);
		}

		tabElements.links.forEach(link => link.addEventListener('click', handleTabClick));

		tabElements.panes.forEach(pane => pane.addEventListener('transitionend', handleTransitionEnd));

		elements.mobileDropdown.addEventListener('change', handleMobileDropdown);
	});
</script>

{% schema %}
	{
		"name": "My Account",
		"settings": [
			{
				"type": "text",
				"id": "acnt_titl",
				"label": "Title",
				"default": "Enter Title"
			},
			{
				"type": "header",
				"content": "Order Section Start"
			},
			{
				"id": "ord_btnlink",
				"type": "url",
				"label": "Button Link"
			}
		],
		"presets": [
			{
				"name": "My Account",
				"category": "Account"
			}
		]
	}
{% endschema %}
