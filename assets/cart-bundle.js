var f=Object.defineProperty;var S=(o,t,e)=>t in o?f(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var E=(o,t,e)=>S(o,typeof t!="symbol"?t+"":t,e);import"./pubsub-chunk.js";function _(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}class I extends HTMLElement{constructor(){super(),this.addEventListener("click",t=>{t.preventDefault(),(this.closest("cart-items")||this.closest("cart-drawer-items")).updateQuantity(this.dataset.index,0)})}}customElements.define("cart-remove-button",I);let g=class extends HTMLElement{constructor(){super();E(this,"cartUpdateUnsubscriber");this.lineItemStatusElement=document.getElementById("shopping-cart-line-item-status")||document.getElementById("CartDrawer-LineItemStatus");const e=debounce(r=>{this.onChange(r)},ON_CHANGE_DEBOUNCE_TIMER);this.addEventListener("change",e.bind(this))}connectedCallback(){this.cartUpdateUnsubscriber=subscribe(PUB_SUB_EVENTS.cartUpdate,e=>{e.source!=="cart-items"&&this.onCartUpdate()})}disconnectedCallback(){this.cartUpdateUnsubscriber&&this.cartUpdateUnsubscriber()}onChange(e){this.updateQuantity(e.target.dataset.index,e.target.value,document.activeElement.getAttribute("name"))}onCartUpdate(){fetch("/cart?section_id=main-cart-items").then(e=>e.text()).then(e=>{const n=new DOMParser().parseFromString(e,"text/html").querySelector("cart-items");this.innerHTML=n.innerHTML}).catch(e=>{console.error(e)})}getSectionsToRender(){return[{id:"main-cart-items",section:document.getElementById("main-cart-items").dataset.id,selector:".js-contents"},{id:"cart-icon-bubble",section:"cart-icon-bubble",selector:".shopify-section"},{id:"cart-live-region-text",section:"cart-live-region-text",selector:".shopify-section"},{id:"main-cart-footer",section:document.getElementById("main-cart-footer").dataset.id,selector:".js-contents"}]}updateQuantity(e,r,n){this.enableLoading(e);const a=JSON.stringify({line:e,quantity:r,sections:this.getSectionsToRender().map(i=>i.section),sections_url:window.location.pathname});fetch("".concat(routes.cart_change_url),{...fetchConfig(),body:a}).then(i=>i.text()).then(i=>{const s=JSON.parse(i),m=document.getElementById("Quantity-".concat(e))||document.getElementById("Drawer-quantity-".concat(e)),p=document.querySelectorAll(".cart-item");if(s.errors){m.value=m.getAttribute("value"),this.updateLiveRegions(e,s.errors);return}this.classList.toggle("is-empty",s.item_count===0);const c=document.querySelector("cart-drawer"),y=document.getElementById("main-cart-footer");y&&y.classList.toggle("is-empty",s.item_count===0),c&&c.classList.toggle("is-empty",s.item_count===0),this.getSectionsToRender().forEach(d=>{const b=document.getElementById(d.id).querySelector(d.selector)||document.getElementById(d.id);b.innerHTML=this.getSectionInnerHTML(s.sections[d.section],d.selector)});const u=s.items[e-1]?s.items[e-1].quantity:void 0;let h="";p.length===s.items.length&&u!==parseInt(m.value)&&(typeof u>"u"?h=window.cartStrings.error:h=window.cartStrings.quantityError.replace("[quantity]",u)),this.updateLiveRegions(e,h);const l=document.getElementById("CartItem-".concat(e))||document.getElementById("CartDrawer-Item-".concat(e));l&&l.querySelector('[name="'.concat(n,'"]'))?c?trapFocus(c,l.querySelector('[name="'.concat(n,'"]'))):l.querySelector('[name="'.concat(n,'"]')).focus():s.item_count===0&&c?trapFocus(c.querySelector(".drawer__inner-empty"),c.querySelector("a")):document.querySelector(".cart-item")&&c&&trapFocus(c,document.querySelector(".cart-item__name")),publish(PUB_SUB_EVENTS.cartUpdate,{source:"cart-items"})}).catch(()=>{this.querySelectorAll(".loading-overlay").forEach(s=>s.classList.add("hidden"));const i=document.getElementById("cart-errors")||document.getElementById("CartDrawer-CartErrors");i.textContent=window.cartStrings.error}).finally(()=>{this.disableLoading(e)})}updateLiveRegions(e,r){const n=document.getElementById("Line-item-error-".concat(e))||document.getElementById("CartDrawer-LineItemError-".concat(e));n&&(n.querySelector(".cart-item__error-text").innerHTML=r),this.lineItemStatusElement.setAttribute("aria-hidden",!0);const a=document.getElementById("cart-live-region-text")||document.getElementById("CartDrawer-LiveRegionText");a.setAttribute("aria-hidden",!1),setTimeout(()=>{a.setAttribute("aria-hidden",!0)},1e3)}getSectionInnerHTML(e,r){return new DOMParser().parseFromString(e,"text/html").querySelector(r).innerHTML}enableLoading(e){(document.getElementById("main-cart-items")||document.getElementById("CartDrawer-CartItems")).classList.add("cart__items--disabled");const n=this.querySelectorAll("#CartItem-".concat(e," .loading-overlay")),a=this.querySelectorAll("#CartDrawer-Item-".concat(e," .loading-overlay"));[...n,...a].forEach(i=>i.classList.remove("hidden")),document.activeElement.blur(),this.lineItemStatusElement.setAttribute("aria-hidden",!1)}disableLoading(e){(document.getElementById("main-cart-items")||document.getElementById("CartDrawer-CartItems")).classList.remove("cart__items--disabled");const n=this.querySelectorAll("#CartItem-".concat(e," .loading-overlay")),a=this.querySelectorAll("#CartDrawer-Item-".concat(e," .loading-overlay"));n.forEach(i=>i.classList.add("hidden")),a.forEach(i=>i.classList.add("hidden"))}};customElements.define("cart-items",g);window.CartItems=g;customElements.get("cart-note")||customElements.define("cart-note",class extends HTMLElement{constructor(){super(),this.addEventListener("change",debounce(t=>{const e=JSON.stringify({note:t.target.value});fetch("".concat(routes.cart_update_url),{...fetchConfig(),body:e})},ON_CHANGE_DEBOUNCE_TIMER))}});class v extends HTMLElement{constructor(){super(),this.addEventListener("keyup",t=>t.code==="Escape"&&this.close()),this.querySelector("#CartDrawer-Overlay").addEventListener("click",this.close.bind(this)),this.setHeaderCartIconAccessibility()}setHeaderCartIconAccessibility(){const t=document.querySelector("#cart-icon-bubble");t&&(t.setAttribute("role","button"),t.setAttribute("aria-haspopup","dialog"),t.addEventListener("click",e=>{e.preventDefault(),this.open(t)}),t.addEventListener("keydown",e=>{e.code.toUpperCase()==="SPACE"&&(e.preventDefault(),this.open(t))}))}open(t){t&&this.setActiveElement(t);const e=this.querySelector('[id^="Details-"] summary');e&&!e.hasAttribute("role")&&this.setSummaryAccessibility(e),setTimeout(()=>{this.classList.add("animate","active")}),this.addEventListener("transitionend",()=>{const r=this.classList.contains("is-empty")?this.querySelector(".drawer__inner-empty"):document.getElementById("CartDrawer"),n=this.querySelector(".drawer__inner")||this.querySelector(".drawer__close");trapFocus(r,n)},{once:!0}),document.body.classList.add("overflow-hidden")}close(){this.classList.remove("active"),removeTrapFocus(this.activeElement),document.body.classList.remove("overflow-hidden")}setSummaryAccessibility(t){t.setAttribute("role","button"),t.setAttribute("aria-expanded","false"),t.nextElementSibling.getAttribute("id")&&t.setAttribute("aria-controls",t.nextElementSibling.id),t.addEventListener("click",e=>{e.currentTarget.setAttribute("aria-expanded",!e.currentTarget.closest("details").hasAttribute("open"))}),t.parentElement.addEventListener("keyup",onKeyUpEscape)}renderContents(t){this.querySelector(".drawer__inner").classList.contains("is-empty")&&this.querySelector(".drawer__inner").classList.remove("is-empty"),this.productId=t.id,this.getSectionsToRender().forEach(e=>{const r=e.selector?document.querySelector(e.selector):document.getElementById(e.id);r.innerHTML=this.getSectionInnerHTML(t.sections[e.id],e.selector)}),setTimeout(()=>{this.querySelector("#CartDrawer-Overlay").addEventListener("click",this.close.bind(this)),this.open()})}getSectionInnerHTML(t,e=".shopify-section"){return new DOMParser().parseFromString(t,"text/html").querySelector(e).innerHTML}getSectionsToRender(){return[{id:"cart-drawer",selector:"#CartDrawer"},{id:"cart-icon-bubble"}]}getSectionDOM(t,e=".shopify-section"){return new DOMParser().parseFromString(t,"text/html").querySelector(e)}setActiveElement(t){this.activeElement=t}}customElements.define("cart-drawer",v);class L extends CartItems{getSectionsToRender(){return[{id:"CartDrawer",section:"cart-drawer",selector:".drawer__inner"},{id:"cart-icon-bubble",section:"cart-icon-bubble",selector:".shopify-section"}]}}customElements.define("cart-drawer-items",L);class C extends HTMLElement{constructor(){super(),this.notification=document.getElementById("cart-notification"),this.header=document.querySelector("sticky-header"),this.onBodyClick=this.handleBodyClick.bind(this),this.notification.addEventListener("keyup",t=>t.code==="Escape"&&this.close()),this.querySelectorAll('button[type="button"]').forEach(t=>t.addEventListener("click",this.close.bind(this)))}open(){this.notification.classList.add("animate","active"),this.notification.addEventListener("transitionend",()=>{this.notification.focus(),trapFocus(this.notification)},{once:!0}),document.body.addEventListener("click",this.onBodyClick)}close(){this.notification.classList.remove("active"),document.body.removeEventListener("click",this.onBodyClick),removeTrapFocus(this.activeElement)}renderContents(t){this.cartItemKey=t.key,this.getSectionsToRender().forEach(e=>{document.getElementById(e.id).innerHTML=this.getSectionInnerHTML(t.sections[e.id],e.selector)}),this.header&&this.header.reveal(),this.open()}getSectionsToRender(){return[{id:"cart-notification-product",selector:'[id="cart-notification-product-'.concat(this.cartItemKey,'"]')},{id:"cart-notification-button"},{id:"cart-icon-bubble"}]}getSectionInnerHTML(t,e=".shopify-section"){return new DOMParser().parseFromString(t,"text/html").querySelector(e).innerHTML}handleBodyClick(t){const e=t.target;if(e!==this.notification&&!e.closest("cart-notification")){const r=e.closest("details-disclosure, header-menu");this.activeElement=r?r.querySelector("summary"):null,this.close()}}setActiveElement(t){this.activeElement=t}}customElements.define("cart-notification",C);console.log("ðŸ›’ Cart bundle loaded - Cart functionality initialized");export{_ as __vite_legacy_guard};
